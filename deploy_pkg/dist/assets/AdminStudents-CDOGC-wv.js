import{c as f,r as t,a as p,s as U,e as F,g,G as P,j as e,S as q,C as L,X as I}from"./index-CEBuFF1J.js";import{u as O,a as R}from"./usePagination-BWburG08.js";import{F as T}from"./funnel-get3pUU9.js";import{M as _}from"./mail-jGcqzQIi.js";import{C as H}from"./check-D2ympk1C.js";/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const G=[["path",{d:"m16 11 2 2 4-4",key:"9rsbq5"}],["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],X=f("user-check",G);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const B=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]],y=f("user-x",B),j=t.memo(({stat:a})=>e.jsx("article",{className:"glass-panel p-5 rounded-2xl","aria-label":`${a.label}: ${a.value}`,children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:`w-12 h-12 rounded-xl bg-gradient-to-br ${a.color} flex items-center justify-center`,"aria-hidden":"true",children:e.jsx(a.icon,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm",children:a.label}),e.jsx("p",{className:"text-2xl font-bold text-white",children:a.value})]})]})}));j.displayName="StatCard";const w=t.memo(({student:a,onDelete:c,onEmail:n})=>{const r=t.useCallback(()=>{window.confirm("هل أنت متأكد من حذف هذا الطالب؟")&&c(a.id)},[a.id,c]),m=t.useCallback(()=>{n(a.email)},[a.email,n]),d=t.useMemo(()=>{switch(a.status){case"active":return"نشط";case"inactive":return"غير نشط";default:return"معلق"}},[a.status]),o=t.useMemo(()=>{switch(a.status){case"active":return"bg-emerald-500/20 text-emerald-400";case"inactive":return"bg-red-500/20 text-red-400";default:return"bg-amber-500/20 text-amber-400"}},[a.status]);return e.jsxs("tr",{className:"border-b border-white/5 hover:bg-white/5 transition-colors",children:[e.jsx("td",{className:"py-4 px-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("img",{src:a.avatar,alt:`صورة ${a.name}`,className:"w-10 h-10 rounded-full bg-white/5",loading:"lazy"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium",children:a.name}),e.jsx("p",{className:"text-gray-400 text-sm",children:a.email})]})]})}),e.jsx("td",{className:"py-4 px-6",children:e.jsxs("div",{className:"flex items-center gap-2 text-gray-300",children:[e.jsx(L,{className:"w-4 h-4","aria-hidden":"true"}),e.jsx("span",{children:a.joinDate})]})}),e.jsxs("td",{className:"py-4 px-6 text-white",children:["المستوى ",a.level]}),e.jsx("td",{className:"py-4 px-6",children:e.jsx("span",{className:"text-emerald-400 font-bold",children:a.points})}),e.jsx("td",{className:"py-4 px-6",children:e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${o}`,children:d})}),e.jsx("td",{className:"py-4 px-6",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:m,className:"p-2 rounded-lg bg-white/5 hover:bg-white/10 text-gray-300 hover:text-white transition-colors","aria-label":`إرسال بريد إلى ${a.name}`,children:e.jsx(_,{className:"w-4 h-4","aria-hidden":"true"})}),e.jsx("button",{onClick:r,className:"p-2 rounded-lg bg-white/5 hover:bg-white/10 text-gray-300 hover:text-white transition-colors","aria-label":`حذف ${a.name}`,children:e.jsx(y,{className:"w-4 h-4 text-red-400","aria-hidden":"true"})})]})})]})});w.displayName="StudentRow";const N=t.memo(({isOpen:a,onClose:c,onSubmit:n})=>{const[r,m]=t.useState({name:"",email:"",password:"",role:"student"}),d=t.useCallback(l=>{l.preventDefault(),!(!r.name||!r.email||!r.password)&&(n(r),m({name:"",email:"",password:"",role:"student"}))},[r,n]),o=t.useCallback((l,x)=>{m(h=>({...h,[l]:x}))},[]);return a?e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/80 backdrop-blur-sm p-4",role:"dialog","aria-modal":"true","aria-labelledby":"modal-title",children:e.jsxs("div",{className:"bg-[#0a1815] border border-white/10 rounded-3xl w-full max-w-lg p-6 relative animate-fade-in border-t border-emerald-500/20",children:[e.jsx("button",{onClick:c,className:"absolute left-4 top-4 text-gray-400 hover:text-white transition-colors","aria-label":"إغلاق النافذة",children:e.jsx(I,{className:"w-6 h-6","aria-hidden":"true"})}),e.jsx("h3",{id:"modal-title",className:"text-2xl font-bold text-white mb-6 font-serif",children:"إضافة طالب جديد"}),e.jsxs("form",{onSubmit:d,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"name",className:"block text-gray-400 text-sm mb-2",children:"الاسم الكامل"}),e.jsx("input",{id:"name",type:"text",required:!0,value:r.name,onChange:l=>o("name",l.target.value),className:"w-full bg-white/5 border border-white/10 rounded-xl px-4 py-3 text-white focus:outline-none focus:border-emerald-500 focus:ring-2 focus:ring-emerald-500/20",placeholder:"أدخل اسم الطالب"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"block text-gray-400 text-sm mb-2",children:"البريد الإلكتروني"}),e.jsx("input",{id:"email",type:"email",required:!0,value:r.email,onChange:l=>o("email",l.target.value),className:"w-full bg-white/5 border border-white/10 rounded-xl px-4 py-3 text-white focus:outline-none focus:border-emerald-500 focus:ring-2 focus:ring-emerald-500/20",placeholder:"example@domain.com"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"block text-gray-400 text-sm mb-2",children:"كلمة المرور المؤقتة"}),e.jsx("input",{id:"password",type:"password",required:!0,value:r.password,onChange:l=>o("password",l.target.value),className:"w-full bg-white/5 border border-white/10 rounded-xl px-4 py-3 text-white focus:outline-none focus:border-emerald-500 focus:ring-2 focus:ring-emerald-500/20",placeholder:"******"})]}),e.jsxs("div",{className:"pt-4 flex gap-3",children:[e.jsx("button",{type:"button",onClick:c,className:"flex-1 py-3 bg-white/5 hover:bg-white/10 rounded-xl text-gray-300 font-bold transition-colors",children:"إلغاء"}),e.jsxs("button",{type:"submit",className:"flex-1 py-3 bg-emerald-600 hover:bg-emerald-500 rounded-xl text-white font-bold transition-colors flex items-center justify-center gap-2",children:[e.jsx(H,{className:"w-5 h-5","aria-hidden":"true"}),e.jsx("span",{children:"إضافة الطالب"})]})]})]})]})}):null});N.displayName="AddStudentModal";const J=t.memo(()=>{const[a,c]=t.useState([]),[n,r]=t.useState(""),[m,d]=t.useState(!1),o=O(n,300),l=t.useCallback(async()=>{try{const s=await p.getUsers();Array.isArray(s)&&c(s.filter(i=>i.role==="student"))}catch(s){console.error("Failed to load students",s)}},[]);t.useEffect(()=>{l()},[l]);const x=t.useMemo(()=>{const s=o.toLowerCase();return a.filter(i=>i.name.toLowerCase().includes(s)||i.email.toLowerCase().includes(s))},[a,o]),{paginatedItems:h,currentPage:u,totalPages:b,nextPage:v,prevPage:k}=R(x,{itemsPerPage:10}),C=t.useCallback(async s=>{const i=U(s.name),E=F(s.email);await p.createUser({name:i,nameEn:i,email:E,role:"student",avatar:`https://ui-avatars.com/api/?name=${encodeURIComponent(i)}&background=064e3b&color=fff&size=100`,points:0,level:1,streak:0,joinDate:new Date().toISOString().split("T")[0],status:"active"}),d(!1),l()},[l]),S=t.useCallback(async s=>{await p.deleteUser(s),l()},[l]),M=t.useCallback(s=>{window.location.href=`mailto:${s}`},[]),A=t.useCallback(s=>{r(s.target.value)},[]),$=t.useCallback(()=>{d(!0)},[]),z=t.useCallback(()=>{d(!1)},[]),D=t.useMemo(()=>[{label:"إجمالي الطلاب",value:a.length,icon:g,color:"from-emerald-500 to-teal-600"},{label:"الطلاب النشطين",value:a.filter(s=>s.status==="active").length,icon:X,color:"from-blue-500 to-cyan-600"},{label:"غير نشطين",value:a.filter(s=>s.status==="inactive").length,icon:y,color:"from-amber-500 to-orange-600"},{label:"معدل الإنجاز",value:"0%",icon:P,color:"from-purple-500 to-pink-600"}],[a]);return e.jsxs("div",{className:"animate-fade-in space-y-6 relative",role:"main","aria-label":"إدارة الطلاب",children:[e.jsxs("header",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-bold text-white mb-2",children:"إدارة الطلاب"}),e.jsx("p",{className:"text-gray-300",children:"عرض وإدارة جميع الطلاب المسجلين"})]}),e.jsxs("button",{onClick:$,className:"px-6 py-3 bg-gradient-to-r from-emerald-500 to-teal-600 text-white rounded-xl font-bold hover:opacity-90 transition-opacity shadow-lg flex items-center gap-2 focus:outline-none focus:ring-2 focus:ring-emerald-400","aria-label":"إضافة طالب جديد",children:[e.jsx(g,{className:"w-5 h-5","aria-hidden":"true"}),e.jsx("span",{children:"+ إضافة طالب"})]})]}),e.jsx("section",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4","aria-label":"إحصائيات الطلاب",children:D.map((s,i)=>e.jsx(j,{stat:s},i))}),e.jsxs("section",{className:"glass-panel p-4 rounded-2xl flex flex-col md:flex-row gap-4","aria-label":"البحث والتصفية",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(q,{className:"absolute right-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400","aria-hidden":"true"}),e.jsx("input",{type:"search",value:n,onChange:A,placeholder:"بحث عن طالب...",className:"w-full bg-white/5 border border-white/10 rounded-xl py-3 pr-12 pl-4 text-white placeholder-gray-400 focus:outline-none focus:border-emerald-500 focus:ring-2 focus:ring-emerald-500/20","aria-label":"البحث عن طالب"})]}),e.jsxs("button",{className:"px-6 py-3 bg-white/5 border border-white/10 rounded-xl text-white flex items-center gap-2 hover:bg-white/10 transition-colors","aria-label":"تصفية النتائج",children:[e.jsx(T,{className:"w-5 h-5","aria-hidden":"true"}),e.jsx("span",{children:"تصفية"})]})]}),e.jsx("section",{className:"glass-panel rounded-2xl overflow-hidden","aria-label":"قائمة الطلاب",children:e.jsxs("table",{className:"w-full",role:"grid",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-white/10 bg-white/5",children:[e.jsx("th",{scope:"col",className:"text-right py-4 px-6 text-gray-300 font-medium",children:"الطالب"}),e.jsx("th",{scope:"col",className:"text-right py-4 px-6 text-gray-300 font-medium",children:"تاريخ الانضمام"}),e.jsx("th",{scope:"col",className:"text-right py-4 px-6 text-gray-300 font-medium",children:"المستوى"}),e.jsx("th",{scope:"col",className:"text-right py-4 px-6 text-gray-300 font-medium",children:"النقاط"}),e.jsx("th",{scope:"col",className:"text-right py-4 px-6 text-gray-300 font-medium",children:"الحالة"}),e.jsx("th",{scope:"col",className:"text-right py-4 px-6 text-gray-300 font-medium",children:"إجراءات"})]})}),e.jsx("tbody",{children:h.length>0?h.map(s=>e.jsx(w,{student:s,onDelete:S,onEmail:M},s.id)):e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"py-8 text-center text-gray-400",children:"لا يوجد طلاب مطابقين للبحث"})})})]})}),e.jsxs("nav",{className:"flex justify-between items-center","aria-label":"التنقل بين الصفحات",children:[e.jsxs("p",{className:"text-gray-400","aria-live":"polite",children:["عرض ",x.length," طالب"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:k,disabled:u===1,className:"px-4 py-2 bg-white/5 border border-white/10 rounded-lg text-gray-300 hover:bg-white/10 disabled:opacity-50 disabled:cursor-not-allowed","aria-label":"الصفحة السابقة",children:"السابق"}),e.jsxs("span",{className:"px-4 py-2 text-white",children:[u," / ",b]}),e.jsx("button",{onClick:v,disabled:u===b,className:"px-4 py-2 bg-white/5 border border-white/10 rounded-lg text-gray-300 hover:bg-white/10 disabled:opacity-50 disabled:cursor-not-allowed","aria-label":"الصفحة التالية",children:"التالي"})]})]}),e.jsx(N,{isOpen:m,onClose:z,onSubmit:C})]})});J.displayName="AdminStudents";export{J as default};
