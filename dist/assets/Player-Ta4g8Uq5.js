import{d as g,u as Ie,a as $e,r as l,c as p,j as e,A as Pe,H as Le,L as S,C as O,e as Te}from"./index-PO4O9_Fr.js";import _e from"./Quiz-Ner9faGs.js";import{B as Ae}from"./book-BSKb7tQp.js";import{P as K}from"./play-CRP0G9QH.js";import{F as Fe}from"./file-text-TCn9I7PS.js";import"./star-DEkBOYX3.js";import"./globe-H-Auzyor.js";import"./send-DS51h8Hw.js";import"./circle-check-Cvzek-8H.js";import"./eye-DOTsDHGN.js";/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Re=[["path",{d:"M8 3H5a2 2 0 0 0-2 2v3",key:"1dcmit"}],["path",{d:"M21 8V5a2 2 0 0 0-2-2h-3",key:"1e4gt3"}],["path",{d:"M3 16v3a2 2 0 0 0 2 2h3",key:"wsl5sc"}],["path",{d:"M16 21h3a2 2 0 0 0 2-2v-3",key:"18trek"}]],qe=g("maximize",Re);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const De=[["path",{d:"M8 3v3a2 2 0 0 1-2 2H3",key:"hohbtr"}],["path",{d:"M21 8h-3a2 2 0 0 1-2-2V3",key:"5jw1f3"}],["path",{d:"M3 16h3a2 2 0 0 1 2 2v3",key:"198tvr"}],["path",{d:"M16 21v-3a2 2 0 0 1 2-2h3",key:"ph8mxp"}]],he=g("minimize",De);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Be=[["rect",{x:"14",y:"3",width:"5",height:"18",rx:"1",key:"kaeet6"}],["rect",{x:"5",y:"3",width:"5",height:"18",rx:"1",key:"1wsw3u"}]],Qe=g("pause",Be);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ve=[["path",{d:"m17 2 4 4-4 4",key:"nntrym"}],["path",{d:"M3 11v-1a4 4 0 0 1 4-4h14",key:"84bu3i"}],["path",{d:"m7 22-4-4 4-4",key:"1wqhfi"}],["path",{d:"M21 13v1a4 4 0 0 1-4 4H3",key:"1rx37r"}]],He=g("repeat",Ve);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ue=[["path",{d:"M17.971 4.285A2 2 0 0 1 21 6v12a2 2 0 0 1-3.029 1.715l-9.997-5.998a2 2 0 0 1-.003-3.432z",key:"15892j"}],["path",{d:"M3 20V4",key:"1ptbpl"}]],Oe=g("skip-back",Ue);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ke=[["path",{d:"M21 4v16",key:"7j8fe9"}],["path",{d:"M6.029 4.285A2 2 0 0 0 3 6v12a2 2 0 0 0 3.029 1.715l9.997-5.998a2 2 0 0 0 .003-3.432z",key:"zs4d6"}]],fe=g("skip-forward",Ke);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const We=[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["path",{d:"M16 9a5 5 0 0 1 0 6",key:"1q6k2b"}],["path",{d:"M19.364 18.364a9 9 0 0 0 0-12.728",key:"ijwkga"}]],Xe=g("volume-2",We);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ge=[["path",{d:"M11 4.702a.705.705 0 0 0-1.203-.498L6.413 7.587A1.4 1.4 0 0 1 5.416 8H3a1 1 0 0 0-1 1v6a1 1 0 0 0 1 1h2.416a1.4 1.4 0 0 1 .997.413l3.383 3.384A.705.705 0 0 0 11 19.298z",key:"uqj9uw"}],["line",{x1:"22",x2:"16",y1:"9",y2:"15",key:"1ewh16"}],["line",{x1:"16",x2:"22",y1:"9",y2:"15",key:"5ykzw1"}]],Je=g("volume-x",Ge),dt=({course:i,onBack:pe,onPlayCourse:ge})=>{const{t:be}=Ie(),{user:s,updateUser:Ye}=$e(),[x,w]=l.useState(!1),[$,W]=l.useState(0),[P,X]=l.useState(0),n=l.useRef(null),G=l.useRef(null),[h,J]=l.useState(i.progress===100),[f,L]=l.useState(0),b=l.useMemo(()=>i.episodes&&i.episodes.length>0?i.episodes:[{id:"default",title:i.title,videoUrl:i.videoUrl||"",orderIndex:0,lastPosition:0,watchedDuration:0,completed:!1}],[i]),m=b[f],[y,z]=l.useState(m.progress||0),[C,ve]=l.useState(!1),[E,we]=l.useState([]),[j,T]=l.useState(null),[_,Y]=l.useState([]),[Ze,ye]=l.useState(!0),[A,Z]=l.useState(!1),[F,je]=l.useState(1),[M,R]=l.useState(m.lastPosition||0),[Ne,q]=l.useState(!1),[ee,N]=l.useState(!0),[te,se]=l.useState(!1),[D,re]=l.useState(!1),[k,B]=l.useState(!1),[I,ae]=l.useState(null),[Q,ke]=l.useState([]),[V,Se]=l.useState(()=>{var a;const t=(i.episodes||[]).findIndex(r=>!r.completed);return t===-1?(((a=i.episodes)==null?void 0:a.length)||1)-1:t}),le=m.videoUrl||"https://storage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4",ze=l.useMemo(()=>{const t=[];return E.filter(a=>a.afterEpisodeIndex===0).forEach(a=>{t.push({type:"quiz",data:a})}),b.forEach((a,r)=>{t.push({type:"episode",data:a,index:r}),E.filter(c=>c.afterEpisodeIndex===r+1).forEach(c=>{t.push({type:"quiz",data:c})})}),t},[b,E]),H=l.useCallback(async(t=!1)=>{if(!n.current||(s==null?void 0:s.role)==="admin"||(s==null?void 0:s.role)==="supervisor"||!D&&m.lastPosition>0)return;const a=n.current.currentTime;n.current.duration;try{await p.updateEpisodeProgress(i.id,m.id,t||h||m.completed,a,Math.max(a,m.watchedDuration||0))}catch(r){console.error("Failed to save progress:",r)}},[i.id,m,s==null?void 0:s.role,D,h]);l.useEffect(()=>{let t;return x&&!j&&(t=setInterval(()=>{H()},1e4)),()=>clearInterval(t)},[x,j,H]);const Ce=()=>{var a;const t=((a=n.current)==null?void 0:a.duration)||0;if(W(t),!D){const r=m.lastPosition||0;r>0&&r<t-2&&(n.current.currentTime=r,X(r)),re(!0)}};l.useEffect(()=>{re(!1),R(m.lastPosition||0),z(m.progress||0),f>V&&Se(f)},[f,V]);const[ne,U]=l.useState(null);l.useEffect(()=>{(async()=>{try{const a=await p.getQuizzes();we(a.filter(o=>o.courseId===i.id));const c=(await p.quizResults.get()).filter(o=>{var d;return o.percentage>=(((d=a.find(ue=>ue.id===o.quizId))==null?void 0:d.passingScore)||70)}).map(o=>o.quizId);Y(c);const u=await p.getCourses();if(ke(u),s){const o=await p.getFavorites(s.id);Z(o.some(d=>String(d.targetId)===String(i.id)&&d.type==="course"))}try{const o=await fetch(`http://localhost:5000/api/books/course/${i.id}`);if(o.ok){const d=await o.json();U(d)}else U(null)}catch(o){console.error("Failed to fetch book:",o),U(null)}}catch(a){console.error("Error loading player data:",a)}finally{ye(!1)}})()},[i.id]),l.useEffect(()=>{if(Q.length>0&&i){const t=[...Q].sort((r,c)=>(r.orderIndex||0)-(c.orderIndex||0)),a=t.findIndex(r=>String(r.id)===String(i.id));a!==-1&&a<t.length-1?ae(t[a+1]):ae(null)}},[Q,i]),l.useEffect(()=>{n.current&&(x?n.current.play():n.current.pause())},[x]),l.useEffect(()=>{const t=()=>{ve(!!document.fullscreenElement)};return document.addEventListener("fullscreenchange",t),()=>document.removeEventListener("fullscreenchange",t)},[]);const oe=()=>{var t;document.fullscreenElement?document.exitFullscreen():(t=G.current)==null||t.requestFullscreen()},Ee=()=>{if(n.current){const t=n.current.currentTime,a=n.current.duration;X(t),W(a||0),t>M&&R(t);const r=Math.floor(t/a*100);z(r)}};l.useEffect(()=>{const t=()=>{document.hidden&&x&&(s==null?void 0:s.role)!=="admin"&&(s==null?void 0:s.role)!=="supervisor"&&(w(!1),q(!0))},a=r=>{r.key==="PrintScreen"&&(s==null?void 0:s.role)!=="admin"&&(s==null?void 0:s.role)!=="supervisor"&&(q(!0),r.preventDefault())};return document.addEventListener("visibilitychange",t),document.addEventListener("keydown",a),()=>{document.removeEventListener("visibilitychange",t),document.removeEventListener("keydown",a)}},[x]),l.useEffect(()=>{n.current&&(n.current.playbackRate=F)},[F]),l.useEffect(()=>{n.current&&(n.current.muted=k)},[k]);const ie=async()=>{var c,u;const t=((c=n.current)==null?void 0:c.currentTime)||0,a=((u=n.current)==null?void 0:u.duration)||0;await p.updateEpisodeProgress(i.id,m.id,!0,a>0?a:t,a>0?a:t);let r=E.find(o=>o.afterEpisodeIndex===f+1);if(r&&_.includes(r.id)&&(r=void 0),r&&(s==null?void 0:s.role)!=="admin"&&(s==null?void 0:s.role)!=="supervisor"){T(r);return}f===b.length-1?(p.updateCourseProgress(i.id,100),J(!0)):(L(o=>o+1),R(0),z(0))},Me=async()=>{if(s)try{const t=await p.toggleFavorite(s.id,i.id,"course");t&&Z(t.action==="added")}catch(t){console.error("Error toggling favorite:",t)}},ce=t=>{if((s==null?void 0:s.role)==="admin"||(s==null?void 0:s.role)==="supervisor"||t===0||t<=V)return!1;const a=b[t-1];return!(a&&a.completed)},de=t=>{if(!t)return"00:00";const a=Math.floor(t/60),r=Math.floor(t%60);return`${a}:${r<10?"0":""}${r}`};return e.jsxs("div",{className:"flex flex-col h-full animate-fade-in pb-10",children:[e.jsxs("button",{onClick:pe,className:"flex items-center gap-2 text-gray-400 hover:text-white mb-6 w-fit transition-colors",children:[e.jsx(Pe,{className:"w-5 h-5"}),e.jsx("span",{children:be("player.backToCourses")})]}),j?e.jsx("div",{className:"flex-1",children:e.jsx(_e,{quiz:j,onSuccess:()=>{Y(t=>[...t,j.id])},onClose:()=>{_.includes(j.id)&&(f<b.length-1?L(t=>t+1):J(!0)),T(null)}})}):e.jsxs("div",{className:"flex-1 flex flex-col-reverse md:flex-row gap-8 items-center justify-center",children:[e.jsxs("div",{className:"w-full md:w-96 flex flex-col gap-4 h-full max-h-[85vh]",children:[e.jsxs("div",{className:"w-full bg-black/20 backdrop-blur-lg p-4 rounded-2xl border border-white/10 shadow-xl flex flex-col gap-4",children:[e.jsxs("div",{className:"flex justify-between items-start gap-2",children:[e.jsxs("div",{className:"min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h2",{className:"text-lg font-bold text-white mb-1 truncate leading-tight",children:m.title}),e.jsx("button",{onClick:Me,className:`p-1 rounded-lg transition-colors ${A?"text-red-500 hover:text-red-400":"text-gray-400 hover:text-white"}`,title:A?"إزالة من المفضلة":"إضافة للمفضلة",children:e.jsx(Le,{className:`w-4 h-4 ${A?"fill-current":""}`})}),ne&&e.jsx("a",{href:`https://pub-7ec5f52937cb4e729e07ecf35b1cf007.r2.dev/Books/${ne.path}`,target:"_blank",rel:"noopener noreferrer",className:"p-1 rounded-lg transition-colors text-emerald-400 hover:text-emerald-300 hover:bg-emerald-500/10",title:"تحميل الكتاب المرافق",download:!0,children:e.jsx(Ae,{className:"w-4 h-4"})})]}),e.jsx("p",{className:"text-violet-400 text-xs font-medium truncate",children:i.instructor})]}),e.jsxs("button",{onClick:ie,disabled:(s==null?void 0:s.role)!=="admin"&&(s==null?void 0:s.role)!=="supervisor"&&y<100&&!h,className:`px-3 py-1.5 rounded-lg text-white text-xs font-bold transition-all shadow-lg flex-shrink-0 flex items-center gap-1 ${(s==null?void 0:s.role)!=="admin"&&y<100&&!h?"bg-gray-600 cursor-not-allowed opacity-50":"bg-gradient-to-r from-emerald-600 to-teal-600 hover:from-emerald-500 hover:to-teal-500"}`,children:[(s==null?void 0:s.role)!=="admin"&&(s==null?void 0:s.role)!=="supervisor"&&y<100&&!h?e.jsx(S,{className:"w-3 h-3"}):e.jsx(O,{className:"w-3.5 h-3.5"}),f===b.length-1?"إكمال":"التالي"]})]}),h&&I&&!I.isLocked&&e.jsxs("button",{onClick:()=>ge(I),className:"w-full py-4 bg-violet-600 hover:bg-violet-500 text-white rounded-xl font-bold transition-all shadow-lg flex items-center justify-center gap-3 animate-bounce-subtle",children:[e.jsx(fe,{className:"w-5 h-5"}),e.jsxs("span",{children:["الانتقال للمساق التالي: ",I.title]})]})]}),e.jsxs("div",{className:"space-y-1 group",dir:"ltr",children:[e.jsx("input",{type:"range",value:y,onChange:t=>{const a=Number(t.target.value),r=a/100*$;(s==null?void 0:s.role)==="admin"||(s==null?void 0:s.role)==="supervisor"||r<=M||h||r<P?(z(a),n.current&&$&&(n.current.currentTime=r)):console.warn("Seeking forward is restricted until content is watched.")},style:{background:`linear-gradient(to right, #8b5cf6 ${y}%, rgba(255,255,255,0.1) ${y}%)`},className:"w-full h-1 rounded-lg appearance-none cursor-pointer hover:h-1.5 transition-all"}),e.jsxs("div",{className:"flex justify-between text-[9px] text-gray-400 font-mono",children:[e.jsx("span",{children:de(P)}),e.jsx("span",{children:de($)})]})]}),e.jsxs("div",{className:"flex items-center justify-between",dir:"rtl",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:()=>{var t,a;x?(t=n.current)==null||t.pause():(a=n.current)==null||a.play(),w(!x)},className:"w-10 h-10 rounded-full bg-violet-600 hover:bg-violet-500 text-white flex items-center justify-center shadow-lg transition-all hover:scale-105",children:x?e.jsx(Qe,{className:"w-4 h-4 fill-current"}):e.jsx(K,{className:"w-4 h-4 fill-current pl-0.5"})}),e.jsxs("div",{className:"flex items-center gap-2 group",children:[e.jsx("button",{onClick:()=>B(t=>!t),className:"p-1.5 rounded-full hover:bg-white/10 text-gray-300 hover:text-white transition-colors",children:k?e.jsx(Je,{className:"w-4 h-4 text-red-400"}):e.jsx(Xe,{className:"w-4 h-4"})}),e.jsx("input",{type:"range",min:"0",max:"1",step:"0.1",defaultValue:"1",dir:"ltr",onChange:t=>{const a=Number(t.target.value);n.current&&(n.current.volume=a,a>0&&k?B(!1):a===0&&!k&&B(!0))},className:"w-16 h-1 bg-white/10 rounded-lg accent-gray-400 hover:accent-white hidden sm:block"})]}),e.jsxs("select",{value:F,onChange:t=>je(Number(t.target.value)),className:"bg-black/40 border border-white/10 rounded-lg px-2 py-1 text-[10px] text-gray-300 focus:outline-none focus:border-violet-500",dir:"ltr",children:[e.jsx("option",{value:"0.25",children:"0.25x"}),e.jsx("option",{value:"0.5",children:"0.5x"}),e.jsx("option",{value:"0.75",children:"0.75x"}),e.jsx("option",{value:"1",children:"1.0x"}),e.jsx("option",{value:"1.25",children:"1.25x"}),e.jsx("option",{value:"1.5",children:"1.5x"}),e.jsx("option",{value:"2",children:"2.0x"})]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:()=>{if(n.current){const t=n.current.currentTime+10;(s==null?void 0:s.role)==="admin"||(s==null?void 0:s.role)==="supervisor"||t<=M||h?n.current.currentTime=t:console.warn("Cannot skip forward beyond watched content.")}},className:`p-1.5 rounded-full transition-colors ${(s==null?void 0:s.role)==="admin"||(s==null?void 0:s.role)==="supervisor"||P+10<=M||h?"hover:bg-white/10 text-gray-300 hover:text-white":"text-gray-600 cursor-not-allowed"}`,title:"+10s",children:e.jsx(fe,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>{n.current&&(n.current.currentTime-=10)},className:"p-1.5 rounded-full hover:bg-white/10 text-gray-300 hover:text-white transition-colors",title:"-10s",children:e.jsx(Oe,{className:"w-4 h-4"})}),e.jsx("button",{onClick:oe,className:"p-1.5 rounded-full hover:bg-white/10 text-gray-300 hover:text-white transition-colors",children:C?e.jsx(he,{className:"w-4 h-4"}):e.jsx(qe,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{className:"flex-1 flex flex-col min-h-0 glass-panel border border-white/5 rounded-2xl overflow-hidden",children:[e.jsx("div",{className:"p-3 border-b border-white/5 bg-white/[0.02]",children:e.jsxs("h3",{className:"font-bold text-white flex items-center gap-2 text-sm",children:[e.jsx(Fe,{className:"w-4 h-4 text-violet-400"}),"منهج الدورة"]})}),e.jsx("div",{className:"flex-1 overflow-y-auto custom-scrollbar p-2 space-y-2",children:ze.map((t,a)=>{if(t.type==="episode"){const r=t.data,c=t.index,u=!r.completed&&r.watchedDuration>0,o=c===f,d=ce(c),me=(xe=>{if(!xe)return 0;const v=xe.split(":").map(Number);return v.length===2?v[0]*60+v[1]:v.length===3?v[0]*3600+v[1]*60+v[2]:0})(r.duration);return e.jsxs("button",{disabled:d,onClick:()=>L(c),className:`w-full text-right p-2.5 rounded-xl transition-all flex items-start gap-3 group relative ${o?"bg-violet-600/20 border border-violet-500/40 shadow-[0_0_15px_rgba(139,92,246,0.1)]":r.completed?"bg-emerald-600/5 hover:bg-emerald-600/10 border border-emerald-500/10":u?"bg-amber-600/5 hover:bg-amber-600/10 border border-amber-500/20":d?"opacity-50 grayscale cursor-not-allowed":"hover:bg-white/5 border border-transparent"}`,children:[e.jsx("div",{className:`w-5 h-5 rounded flex items-center justify-center flex-shrink-0 mt-0.5 transition-all ${o?"bg-violet-500 text-white ring-2 ring-violet-500/20 animate-pulse":r.completed?"bg-emerald-500 text-white shadow-sm":u?"bg-amber-500 text-white shadow-sm":"bg-black/40 text-gray-400"}`,children:o?e.jsx(K,{className:"w-2.5 h-2.5 fill-current"}):r.completed?e.jsx(O,{className:"w-3 h-3"}):e.jsx("span",{className:"text-[9px] font-bold",children:c+1})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:`text-xs font-medium truncate transition-colors ${o?"text-white font-bold":r.completed?"text-emerald-400":u?"text-amber-400":"text-gray-400"}`,children:r.title}),e.jsxs("div",{className:"flex items-center gap-2 mt-0.5",children:[r.duration&&e.jsx("p",{className:`text-[9px] ${r.completed?"text-emerald-600/60":u?"text-amber-600/60":"text-gray-500"}`,children:r.duration}),u&&me>0&&e.jsx("div",{className:"flex-1 h-0.5 bg-white/5 rounded-full overflow-hidden max-w-[40px]",children:e.jsx("div",{className:"h-full bg-amber-500 rounded-full",style:{width:`${Math.min(100,Math.floor(r.watchedDuration/me*100))}%`}})})]})]}),d?e.jsx(S,{className:"w-3 h-3 text-gray-600 mt-1"}):o?e.jsxs("div",{className:"flex flex-col items-center gap-0.5 mt-1",children:[e.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-violet-500 animate-ping"}),e.jsx("span",{className:"text-[7px] text-violet-400 font-bold uppercase tracking-tighter",children:"الآن"})]}):r.completed?e.jsx("div",{className:"mt-1 flex items-center gap-1",children:e.jsx("span",{className:"text-[8px] text-emerald-500 font-bold opacity-0 group-hover:opacity-100 transition-opacity",children:"مكتمل"})}):u?e.jsx("div",{className:"mt-1",children:e.jsx(He,{className:"w-3 h-3 text-amber-500 opacity-60"})}):null]},`ep-${r.id}`)}else{const r=t.data,c=_.includes(r.id),u=r.afterEpisodeIndex||0,o=(s==null?void 0:s.role)==="admin",d=!o&&u>0&&ce(u);return e.jsxs("div",{onClick:()=>{(o||!d&&!c)&&T(r)},className:`w-full text-right p-3 rounded-xl transition-all flex items-start gap-3 border ${c?"bg-emerald-600/10 border-emerald-500/30 text-emerald-300":d?"bg-white/5 border-transparent opacity-50 grayscale cursor-not-allowed":"bg-amber-600/10 border-amber-500/30 text-amber-300 hover:bg-amber-600/20 cursor-pointer"}`,children:[e.jsx("div",{className:`w-5 h-5 rounded flex items-center justify-center flex-shrink-0 mt-0.5 ${c?"bg-emerald-500 text-white":"bg-amber-500 text-white"}`,children:e.jsx(Te,{className:"w-3 h-3"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-xs font-bold truncate",children:r.title}),e.jsx("p",{className:"text-[9px] opacity-70 mt-0.5",children:c?"تم الاجتياز بنجاح":d?"مغلق حتى إكمال المحاضرة":"اختبار متاح - اضغط للبدء"})]}),c&&e.jsx(O,{className:"w-3.5 h-3.5 text-emerald-400 mt-1"}),d&&e.jsx(S,{className:"w-3 h-3 text-gray-600 mt-1"})]},`quiz-${r.id}`)}})})]})]}),e.jsx("div",{className:"flex-1 w-full flex flex-col items-center justify-center p-2 min-h-[400px]",children:e.jsxs("div",{ref:G,className:`relative group transition-all rounded-2xl overflow-hidden shadow-2xl bg-black ${C?"fixed inset-0 z-50 rounded-none w-full h-full flex items-center justify-center":"w-fit max-w-full mx-auto"}`,style:{height:C?"100vh":"auto"},children:[ee&&!te&&e.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center bg-gray-900/50 backdrop-blur-sm z-10",children:[e.jsx("div",{className:"w-12 h-12 border-4 border-violet-500 border-t-transparent rounded-full animate-spin mb-4"}),e.jsx("p",{className:"text-white text-sm font-medium",children:"جاري تحميل المحتوى..."})]}),te&&e.jsxs("div",{className:"absolute inset-0 flex flex-col items-center justify-center bg-gray-900 z-20 p-6 text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-red-500/20 rounded-full flex items-center justify-center mb-4",children:e.jsx(S,{className:"w-8 h-8 text-red-500"})}),e.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:"عذراً، فشل تحميل الفيديو"}),e.jsx("p",{className:"text-gray-400 text-sm mb-6",children:"يرجى التحقق من اتصال الإنترنت أو المحاولة مرة أخرى لاحقاً."}),e.jsx("button",{onClick:()=>{se(!1),N(!0)},className:"px-6 py-2 bg-violet-600 hover:bg-violet-500 text-white rounded-xl font-bold transition-colors",children:"إعادة المحاولة"})]}),e.jsx("video",{ref:n,src:le,playsInline:!0,preload:"metadata",controlsList:"nodownload",onContextMenu:t=>t.preventDefault(),className:`max-h-[70vh] w-auto max-w-full mx-auto block transition-opacity duration-300 ${ee?"opacity-0":"opacity-100"}`,onPlay:()=>w(!0),onPause:()=>{w(!1),H()},onTimeUpdate:Ee,onWaiting:()=>N(!0),onPlaying:()=>N(!1),onCanPlay:()=>N(!1),onLoadedMetadata:Ce,onError:()=>{se(!0),N(!1)},onEnded:()=>{w(!1),ie()}},le),!x&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/20 hover:bg-black/30 transition-colors cursor-pointer",onClick:()=>w(!0),children:e.jsx("div",{className:"w-20 h-20 bg-white/10 backdrop-blur-md rounded-full flex items-center justify-center shadow-lg border border-white/20 group-hover:scale-110 transition-transform",children:e.jsx(K,{className:"w-10 h-10 text-white fill-current"})})}),C&&e.jsx("div",{className:"absolute top-6 left-6 z-50 animate-fade-in",children:e.jsxs("button",{onClick:oe,className:"bg-black/40 hover:bg-black/60 backdrop-blur-md text-white px-4 py-2 rounded-xl flex items-center gap-2 transition-all border border-white/10 shadow-lg group-hover:opacity-100 opacity-0 transition-opacity duration-3000 delay-1000",style:{opacity:1},children:[e.jsx(he,{className:"w-4 h-5"}),e.jsx("span",{className:"text-sm font-bold",children:"تصغير الشاشة"})]})})]})})]}),Ne&&e.jsx("div",{className:"fixed inset-0 z-[100] flex items-center justify-center p-4 bg-black/90 animate-fade-in backdrop-blur-md",children:e.jsxs("div",{className:"bg-red-600/20 border border-red-500/50 p-8 rounded-3xl max-w-md text-center space-y-4",children:[e.jsx("div",{className:"w-16 h-16 bg-red-500 rounded-full flex items-center justify-center mx-auto mb-4 animate-bounce",children:e.jsx(S,{className:"w-8 h-8 text-white"})}),e.jsx("h3",{className:"text-2xl font-bold text-white",children:"تنبيه أمان!"}),e.jsx("p",{className:"text-red-200",children:"يُمنع تسجيل الشاشة أو مغادرة الصفحة أثناء تشغيل المحتوى. يرجى الالتزام بسياسات المنصة لحماية حقوق الملكية."}),e.jsx("button",{onClick:()=>q(!1),className:"px-6 py-2 bg-white text-red-600 font-bold rounded-xl hover:bg-red-50 transition-colors",children:"فهمت ذلك"})]})})]})};export{dt as default};
