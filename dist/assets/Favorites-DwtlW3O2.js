import{a as k,r as n,b as c,j as e,L,F as E,h as w,m as y,S as A,H as M}from"./index-KPgU3Pk4.js";import{F as S}from"./file-text-DryED74Z.js";import{G as T,L as B}from"./list-CXAfowTy.js";import{P as C}from"./play-DTwEayKN.js";import{T as D}from"./trash-2-PnDG24id.js";const q=()=>{const{user:d}=k(),[h,u]=n.useState("grid"),[a,I]=n.useState("all"),[F,p]=n.useState(!0),[i,f]=n.useState([]),[G,H]=n.useState([]);n.useEffect(()=>{(async()=>{if(d){p(!0);try{const s=await c.users.getFavorites(d.id),l=await c.courses.getCourses(),g=await c.content.getResources(),x=s.map(o=>{let r=null;return o.type==="course"?r=l.find(m=>String(m.id)===String(o.targetId)):r=g.find(m=>String(m.id)===String(o.targetId)),r?{...r,id:o.id,targetId:o.targetId,type:o.type,title:r.title||r.label,instructor:r.instructor||r.author,image:r.image||r.thumbnail}:null}).filter(Boolean);f(x)}catch(s){console.error("Failed to load favorites",s)}finally{p(!1)}}})()},[d,c]);const j=async(t,s)=>{if(d&&confirm("إزالة من المفضلة؟"))try{const l=await c.toggleFavorite(d.id,t,s);(l==null?void 0:l.action)==="removed"&&f(g=>g.filter(x=>!(x.targetId===String(t)&&x.type===s)))}catch(l){console.error("Error toggling favorite",l)}};if(F)return e.jsx(L,{fullScreen:!0});const $=[{id:"all",label:"الكل",icon:E,count:i.length},{id:"course",label:"الدورات",icon:w,count:i.filter(t=>t.type==="course").length},{id:"audio",label:"المقاطع الصوتية",icon:y,count:i.filter(t=>t.type==="audio").length},{id:"document",label:"المستندات",icon:S,count:i.filter(t=>t.type==="document").length}],v=a==="all"?i:i.filter(t=>t.type===a),b={course:w,audio:y,document:S},N={course:"from-emerald-500 to-teal-600",audio:"from-violet-500 to-purple-600",document:"from-amber-500 to-orange-600"};return e.jsxs("div",{className:"animate-fade-in space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-bold text-white mb-2",children:"المفضلة"}),e.jsx("p",{className:"text-gray-300",children:"محتواك المحفوظ للرجوع إليه لاحقاً"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx(A,{className:"absolute right-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"بحث...",className:"bg-white/5 border border-white/10 rounded-xl py-2 pr-10 pl-4 text-white placeholder-gray-400 focus:outline-none focus:border-emerald-500 w-48"})]}),e.jsxs("div",{className:"flex bg-white/5 rounded-xl p-1",children:[e.jsx("button",{onClick:()=>u("grid"),className:`p-2 rounded-lg transition-colors ${h==="grid"?"bg-emerald-500 text-white":"text-gray-400 hover:text-white"}`,children:e.jsx(T,{className:"w-5 h-5"})}),e.jsx("button",{onClick:()=>u("list"),className:`p-2 rounded-lg transition-colors ${h==="list"?"bg-emerald-500 text-white":"text-gray-400 hover:text-white"}`,children:e.jsx(B,{className:"w-5 h-5"})})]})]})]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:$.map(t=>e.jsxs("button",{onClick:()=>I(t.id),className:`glass-panel p-4 rounded-2xl flex items-center gap-4 transition-all ${a===t.id?"border-emerald-500/50 bg-emerald-500/10":"hover:bg-white/5"}`,children:[e.jsx("div",{className:`w-10 h-10 rounded-xl flex items-center justify-center ${a===t.id?"bg-emerald-500":"bg-white/10"}`,children:e.jsx(t.icon,{className:`w-5 h-5 ${a===t.id?"text-white":"text-gray-400"}`})}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:`font-medium ${a===t.id?"text-white":"text-gray-300"}`,children:t.label}),e.jsxs("p",{className:"text-sm text-gray-400",children:[t.count," عنصر"]})]})]},t.id))}),h==="grid"?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:v.map(t=>{const s=b[t.type];return e.jsxs("div",{className:"glass-panel rounded-2xl overflow-hidden group hover:border-emerald-500/50 transition-all",children:[e.jsxs("div",{className:"relative h-40",children:[e.jsx("img",{src:t.image,alt:t.title,className:"w-full h-full object-cover"}),e.jsx("div",{className:"absolute inset-0 bg-gradient-to-t from-black/80 to-transparent"}),e.jsx("div",{className:"absolute top-3 right-3",children:e.jsx("div",{className:`w-8 h-8 rounded-lg bg-gradient-to-br ${N[t.type]} flex items-center justify-center`,children:e.jsx(s,{className:"w-4 h-4 text-white"})})}),e.jsx("button",{onClick:()=>j(t.targetId,t.type),className:"absolute top-3 left-3 p-2 rounded-lg bg-black/50 text-red-500 hover:bg-red-600 hover:text-white transition-colors",children:e.jsx(M,{className:"w-4 h-4 fill-current"})}),e.jsx("div",{className:"absolute bottom-3 left-3 right-3 opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsxs("button",{className:"w-full py-2 bg-emerald-500 rounded-lg text-white text-sm font-medium flex items-center justify-center gap-2",children:[e.jsx(C,{className:"w-4 h-4"})," متابعة"]})})]}),e.jsxs("div",{className:"p-4",children:[e.jsx("h3",{className:"font-bold text-white mb-1",children:t.title}),e.jsx("p",{className:"text-sm text-gray-400",children:t.instructor||t.author}),t.progress!==void 0&&e.jsxs("div",{className:"mt-3",children:[e.jsxs("div",{className:"flex justify-between text-xs text-gray-400 mb-1",children:[e.jsx("span",{children:"التقدم"}),e.jsxs("span",{children:[t.progress,"%"]})]}),e.jsx("div",{className:"h-1.5 bg-white/10 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-emerald-500 to-teal-500 rounded-full",style:{width:`${t.progress}%`}})})]})]})]},t.id)})}):e.jsx("div",{className:"space-y-3",children:v.map(t=>{const s=b[t.type];return e.jsxs("div",{className:"glass-panel p-4 rounded-2xl flex items-center gap-4 hover:border-emerald-500/50 transition-all",children:[e.jsx("div",{className:"w-20 h-20 rounded-xl overflow-hidden flex-shrink-0",children:e.jsx("img",{src:t.image,alt:t.title,className:"w-full h-full object-cover"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("div",{className:`w-6 h-6 rounded-lg bg-gradient-to-br ${N[t.type]} flex items-center justify-center`,children:e.jsx(s,{className:"w-3 h-3 text-white"})}),e.jsx("h3",{className:"font-bold text-white",children:t.title})]}),e.jsx("p",{className:"text-sm text-gray-400",children:t.instructor||t.author}),t.progress!==void 0&&e.jsxs("div",{className:"flex items-center gap-3 mt-2",children:[e.jsx("div",{className:"flex-1 h-1.5 bg-white/10 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-gradient-to-r from-emerald-500 to-teal-500 rounded-full",style:{width:`${t.progress}%`}})}),e.jsxs("span",{className:"text-xs text-emerald-400",children:[t.progress,"%"]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{className:"p-2 rounded-lg bg-emerald-500/20 text-emerald-400 hover:bg-emerald-500 hover:text-white transition-colors",children:e.jsx(C,{className:"w-5 h-5"})}),e.jsx("button",{onClick:()=>j(t.targetId,t.type),className:"p-2 rounded-lg bg-white/5 text-red-400 hover:bg-red-500/20 hover:text-red-500 transition-colors",children:e.jsx(D,{className:"w-5 h-5"})})]})]},t.id)})})]})};export{q as default};
