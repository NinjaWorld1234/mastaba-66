import{r as t,c as R,S as y,g as w,p as N,m as j,j as e,X as I,o as K,q as M,A as B}from"./index-PO4O9_Fr.js";import{u as T}from"./useDebounce-D8YZ8g9s.js";import{u as q}from"./usePagination-yudK0T-c.js";import{F as v}from"./file-text-TCn9I7PS.js";import{C as L}from"./chevron-left-ChsnwwAv.js";import{C as Q}from"./clock-DV4-bnDj.js";function O(a,o={}){const{retries:r=0,retryDelay:c=1e3,onSuccess:s,onError:n}=o,[h,d]=t.useState({data:null,loading:!1,error:null}),p=t.useCallback(async(...x)=>{d(i=>({...i,loading:!0,error:null}));let m=null;for(let i=0;i<=r;i++)try{const u=await a(...x);return d({data:u,loading:!1,error:null}),s==null||s(),u}catch(u){m=u instanceof Error?u.message:"An error occurred",i<r&&await new Promise(f=>setTimeout(f,c))}return d(i=>({...i,loading:!1,error:m})),m&&(n==null||n(m)),null},[a,r,c,s,n]),b=t.useCallback(()=>{d({data:null,loading:!1,error:null})},[]),g=t.useCallback(x=>{d(m=>({...m,data:x}))},[]);return{...h,execute:p,reset:b,setData:g}}const C=t.memo(({result:a,typeColors:o,typeIcons:r})=>{const c=r[a.type],s=t.useCallback(()=>{},[a.title]),n=t.useCallback(h=>{(h.key==="Enter"||h.key===" ")&&(h.preventDefault(),s())},[s]);return e.jsxs("article",{className:"glass-panel p-5 rounded-2xl flex items-center gap-4 hover:border-emerald-500/50 transition-all cursor-pointer group",onClick:s,onKeyDown:n,role:"button",tabIndex:0,"aria-label":`${a.title} - ${a.desc}`,children:[e.jsx("div",{className:`w-14 h-14 rounded-xl bg-gradient-to-br ${o[a.type]} flex items-center justify-center flex-shrink-0 overflow-hidden relative`,"aria-hidden":"true",children:a.thumbnail?e.jsx("img",{src:a.thumbnail,alt:"",className:"w-full h-full object-cover opacity-80 group-hover:opacity-100 transition-opacity"}):e.jsx(c,{className:"w-7 h-7 text-white"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-bold text-white text-lg truncate",children:a.title}),e.jsx("p",{className:"text-gray-400 text-sm mt-1 line-clamp-1",children:a.desc}),e.jsxs("div",{className:"flex items-center gap-4 mt-2 text-xs text-gray-500",children:[a.instructor&&e.jsx("span",{children:a.instructor}),a.author&&e.jsx("span",{children:a.author}),a.duration&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Q,{className:"w-3 h-3","aria-hidden":"true"}),a.duration]}),a.members!==void 0&&e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(j,{className:"w-3 h-3","aria-hidden":"true"}),a.members," ",a.type==="community"?"إعجاب":"عضو"]})]})]}),e.jsx(B,{className:"w-5 h-5 text-gray-400 group-hover:text-emerald-400 group-hover:-translate-x-1 transition-all rtl:rotate-180 rtl:group-hover:translate-x-1","aria-hidden":"true"})]})});C.displayName="ResultCard";const k=t.memo(({filter:a,isActive:o,onClick:r})=>{const c=t.useCallback(s=>{(s.key==="Enter"||s.key===" ")&&(s.preventDefault(),r())},[r]);return e.jsxs("button",{onClick:r,onKeyDown:c,className:`px-4 py-2 rounded-xl text-sm font-medium flex items-center gap-2 transition-all ${o?"bg-gradient-to-r from-emerald-500 to-teal-600 text-white":"bg-white/5 text-gray-300 hover:bg-white/10"}`,role:"radio","aria-checked":o,"aria-label":a.label,children:[e.jsx(a.icon,{className:"w-4 h-4","aria-hidden":"true"}),a.label]})});k.displayName="FilterButton";const U=t.memo(()=>{const[a,o]=t.useState(""),[r,c]=t.useState("all"),s=T(a,300),{data:n,loading:h,execute:d}=O(R.search);t.useEffect(()=>{d(s,r)},[s,r,d]);const{paginatedItems:p,currentPage:b,totalPages:g,nextPage:x,prevPage:m,goToPage:i,hasNextPage:u,hasPrevPage:f}=q(n||[],{itemsPerPage:5}),P=t.useMemo(()=>[{id:"all",label:"الكل",icon:y},{id:"course",label:"دورات",icon:w},{id:"audio",label:"صوتيات",icon:N},{id:"document",label:"مستندات",icon:v},{id:"community",label:"مجتمع",icon:j}],[]),S=t.useMemo(()=>({course:"from-emerald-500 to-teal-600",audio:"from-violet-500 to-purple-600",document:"from-amber-500 to-orange-600",community:"from-blue-500 to-cyan-600"}),[]),D=t.useMemo(()=>({course:w,audio:N,document:v,community:j}),[]),$=t.useCallback(l=>{o(l.target.value)},[]),F=t.useCallback(()=>{o("")},[]),A=t.useCallback(l=>{c(l)},[]);return e.jsxs("div",{className:"animate-fade-in space-y-6",role:"main","aria-label":"البحث",children:[e.jsxs("header",{children:[e.jsx("h2",{className:"text-3xl font-bold text-white mb-2",children:"البحث"}),e.jsx("p",{className:"text-gray-300",children:"ابحث في جميع المحتوى"})]}),e.jsxs("section",{className:"glass-panel p-6 rounded-2xl","aria-label":"مربع البحث",children:[e.jsxs("div",{className:"relative",children:[e.jsx(y,{className:"absolute right-4 top-1/2 -translate-y-1/2 w-6 h-6 text-gray-400 pointer-events-none","aria-hidden":"true"}),e.jsx("input",{type:"search",value:a,onChange:$,placeholder:"ابحث عن دورات، مقاطع صوتية، مستندات...",className:"w-full bg-white/5 border border-white/10 rounded-2xl py-4 pr-14 pl-12 text-white text-lg placeholder-gray-400 focus:outline-none focus:border-emerald-500 focus:ring-2 focus:ring-emerald-500/20","aria-label":"البحث في المحتوى",role:"searchbox"}),a&&e.jsx("button",{onClick:F,className:"absolute left-4 top-1/2 -translate-y-1/2 p-1 rounded-full hover:bg-white/10 transition-colors","aria-label":"مسح البحث",children:e.jsx(I,{className:"w-5 h-5 text-gray-400","aria-hidden":"true"})})]}),e.jsx("div",{className:"flex flex-wrap gap-2 mt-4",role:"radiogroup","aria-label":"تصفية النتائج",children:P.map(l=>e.jsx(k,{filter:l,isActive:r===l.id,onClick:()=>A(l.id)},l.id))})]}),e.jsx("section",{className:"space-y-4","aria-label":"نتائج البحث","aria-live":"polite",children:h?e.jsx("div",{className:"flex justify-center py-12",children:e.jsx(K,{})}):e.jsxs(e.Fragment,{children:[e.jsxs("p",{className:"text-gray-400","aria-atomic":"true",children:[(n==null?void 0:n.length)||0," نتيجة"]}),p.map(l=>e.jsx(C,{result:l,typeColors:S,typeIcons:D},`${l.type}-${l.id}`)),p.length===0&&e.jsxs("div",{className:"glass-panel p-12 text-center rounded-2xl",children:[e.jsx(y,{className:"w-12 h-12 text-white/10 mx-auto mb-4"}),e.jsxs("p",{className:"text-gray-500",children:['لا توجد نتائج للبحث عن "',a,'"']})]}),g>1&&e.jsxs("nav",{className:"flex items-center justify-center gap-2 mt-8","aria-label":"pagination",children:[e.jsx("button",{onClick:m,disabled:!f,className:"p-2 rounded-xl glass-panel hover:bg-white/10 disabled:opacity-30 disabled:cursor-not-allowed transition-all","aria-label":"Previous Page",children:e.jsx(M,{className:"w-5 h-5 rtl:rotate-0 rotate-180 text-white"})}),e.jsx("div",{className:"flex gap-1",children:Array.from({length:g},(l,E)=>E+1).map(l=>e.jsx("button",{onClick:()=>i(l),className:`w-10 h-10 rounded-xl font-bold transition-all ${b===l?"bg-emerald-600 text-white":"glass-panel text-gray-400 hover:bg-white/10"}`,children:l},l))}),e.jsx("button",{onClick:x,disabled:!u,className:"p-2 rounded-xl glass-panel hover:bg-white/10 disabled:opacity-30 disabled:cursor-not-allowed transition-all","aria-label":"Next Page",children:e.jsx(L,{className:"w-5 h-5 rtl:rotate-0 rotate-180 text-white"})})]})]})})]})});U.displayName="Search";export{U as default};
