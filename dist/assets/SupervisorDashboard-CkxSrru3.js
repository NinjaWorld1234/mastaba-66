import{r as l,c as C,m as j,j as e,S as P,l as E,M as D}from"./index-PO4O9_Fr.js";import{R as T}from"./RatingBox-DyT5Ywyi.js";import{u as I}from"./usePagination-yudK0T-c.js";import{u as R}from"./useDebounce-D8YZ8g9s.js";import{U,S as $}from"./StudentDetailsModal-CxLXmen9.js";import{S as B}from"./star-DEkBOYX3.js";import{E as q}from"./eye-DOTsDHGN.js";import"./globe-H-Auzyor.js";import"./trash-2-B1SjAVum.js";import"./send-DS51h8Hw.js";import"./mail--37byxe_.js";import"./map-pin-B659mmqr.js";import"./phone-k7tXVEg0.js";const A=l.memo(({stat:{label:s,value:a,icon:o,color:i}})=>e.jsx("article",{className:"glass-panel p-5 rounded-2xl bg-white/5 border border-white/10",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:`w-12 h-12 rounded-xl bg-gradient-to-br ${i} flex items-center justify-center`,children:e.jsx(o,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm",children:s}),e.jsx("p",{className:"text-2xl font-bold text-white",children:a})]})]})})),F=l.memo(({student:s,onView:a,onMessage:o})=>{var i;return e.jsxs("tr",{className:"border-b border-white/5 hover:bg-white/5 transition-colors",children:[e.jsx("td",{className:"py-4 px-6",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("img",{src:s.avatar,alt:s.name,className:"w-10 h-10 rounded-full bg-white/5"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-white font-medium",children:s.name}),e.jsx("p",{className:"text-gray-400 text-sm",children:s.email})]})]})}),e.jsx("td",{className:"py-4 px-6",children:e.jsxs("div",{className:"flex items-center gap-2 text-gray-300",children:[e.jsx(E,{className:"w-4 h-4"}),e.jsx("span",{children:(i=s.joinDate)==null?void 0:i.split("T")[0]})]})}),e.jsxs("td",{className:"py-4 px-6 text-white",children:["المستوى ",s.level]}),e.jsx("td",{className:"py-4 px-6",children:e.jsxs("div",{className:"flex flex-col gap-1 max-w-[200px]",children:[e.jsx("span",{className:"text-white text-sm line-clamp-1",children:s.activeCourses||"لا يوجد"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"flex-1 h-1.5 bg-white/10 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-emerald-500 rounded-full",style:{width:`${Math.min((s.completedLessons||0)*5,100)}%`}})}),e.jsxs("span",{className:"text-[10px] text-gray-400",children:[s.completedLessons||0," درس"]})]})]})}),e.jsx("td",{className:"py-4 px-6",children:e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${s.status==="active"?"bg-emerald-500/20 text-emerald-400":"bg-red-500/20 text-red-400"}`,children:s.status==="active"?"نشط":"غير نشط"})}),e.jsx("td",{className:"py-4 px-6",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>a(s.id),className:"p-2 rounded-lg bg-white/5 hover:bg-white/10 text-gray-300 hover:text-emerald-400 transition-colors",title:"عرض التفاصيل",children:e.jsx(q,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>o(s.id),className:"p-2 rounded-lg bg-white/5 hover:bg-white/10 text-gray-300 hover:text-white transition-colors",title:"مراسلة الطالب",children:e.jsx(D,{className:"w-4 h-4"})})]})})]})}),se=({onOpenChat:s})=>{const[a,o]=l.useState([]),[i,b]=l.useState(""),[f,n]=l.useState(!1),[w,v]=l.useState(null),[N,h]=l.useState(!0),p=R(i,300),u=l.useCallback(async()=>{h(!0);try{const t=await C.supervisors.getMyStudents();o(t||[])}catch(t){console.error("Failed to load students",t)}finally{h(!1)}},[]);l.useEffect(()=>{u()},[u]);const y=l.useMemo(()=>{const t=p.toLowerCase();return a.filter(r=>r.name.toLowerCase().includes(t)||r.email.toLowerCase().includes(t))},[a,p]),{paginatedItems:g,currentPage:d,totalPages:x,nextPage:S,prevPage:k}=I(y,{itemsPerPage:10}),M=l.useMemo(()=>{const t=a.filter(c=>c.status==="active").length,r=a.reduce((c,m)=>c+(m.points||0),0),L=a.length>0?Math.round(a.reduce((c,m)=>c+(m.level||1),0)/a.length):1;return[{label:"طلابي",value:a.length,icon:j,color:"from-emerald-500 to-teal-600"},{label:"النشطين",value:t,icon:U,color:"from-blue-500 to-cyan-600"},{label:"نقاط المجموعة",value:r,icon:B,color:"from-amber-500 to-orange-600"},{label:"متوسط المستوى",value:L,icon:V,color:"from-purple-500 to-pink-600"}]},[a]);return e.jsxs("div",{className:"animate-fade-in space-y-8 pb-20",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-bold text-white mb-2 font-serif",children:"لوحة تحكم المشرف"}),e.jsx("p",{className:"text-gray-400",children:"إدارة ومتابعة الطلاب المسندين إليك"})]}),e.jsxs("button",{onClick:()=>{const t=new CustomEvent("setActiveTab",{detail:"students"});window.dispatchEvent(t)},className:"px-6 py-3 bg-emerald-600 hover:bg-emerald-500 rounded-2xl text-white font-bold shadow-lg shadow-emerald-600/20 transition-all transform hover:scale-105 flex items-center gap-2",children:[e.jsx(j,{className:"w-5 h-5"}),e.jsx("span",{children:"عرض كافة الطلاب"})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:M.map((t,r)=>e.jsx(A,{stat:t},r))}),e.jsxs("div",{className:"glass-panel rounded-3xl overflow-hidden bg-white/5 border border-white/10",children:[e.jsx("div",{className:"p-6 border-b border-white/10 bg-white/5 flex flex-col md:flex-row gap-4 items-center justify-between",children:e.jsxs("div",{className:"relative w-full md:w-96",children:[e.jsx(P,{className:"absolute right-4 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"بحث عن طالب...",value:i,onChange:t=>b(t.target.value),className:"w-full bg-white/5 border border-white/10 rounded-2xl pr-12 pl-4 py-3 text-white focus:outline-none focus:border-emerald-500 transition-colors"})]})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-right",children:[e.jsx("thead",{className:"bg-white/5 text-gray-400 text-sm",children:e.jsxs("tr",{children:[e.jsx("th",{className:"py-4 px-6 font-bold",children:"الطالب"}),e.jsx("th",{className:"py-4 px-6 font-bold",children:"الانضمام"}),e.jsx("th",{className:"py-4 px-6 font-bold",children:"المستوى"}),e.jsx("th",{className:"py-4 px-6 font-bold",children:"التقدم"}),e.jsx("th",{className:"py-4 px-6 font-bold",children:"الحالة"}),e.jsx("th",{className:"py-4 px-6 font-bold",children:"الإجراءات"})]})}),e.jsxs("tbody",{children:[g.map(t=>e.jsx(F,{student:t,onView:r=>{v(r),n(!0)},onMessage:r=>s==null?void 0:s(r)},t.id)),g.length===0&&!N&&e.jsx("tr",{children:e.jsx("td",{colSpan:6,className:"py-12 text-center text-gray-500",children:"لم يتم العثور على طلاب مطابقين للبحث أو لم يتم إسناد طلاب إليك بعد."})})]})]})}),x>1&&e.jsxs("div",{className:"p-6 border-t border-white/10 flex items-center justify-between",children:[e.jsxs("p",{className:"text-gray-400 text-sm",children:["صفحة ",d," من ",x]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:k,disabled:d===1,className:"px-4 py-2 bg-white/5 hover:bg-white/10 rounded-xl text-white disabled:opacity-50 transition-colors",children:"السابق"}),e.jsx("button",{onClick:S,disabled:d===x,className:"px-4 py-2 bg-white/5 hover:bg-white/10 rounded-xl text-white disabled:opacity-50 transition-colors",children:"التالي"})]})]})]}),e.jsx($,{isOpen:f,onClose:()=>n(!1),studentId:w,onMessage:t=>{s==null||s(t),n(!1)}}),e.jsx("div",{className:"mt-8",children:e.jsx(T,{})})]})},V=({className:s})=>e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:s,children:[e.jsx("polyline",{points:"23 6 13.5 15.5 8.5 10.5 1 18"}),e.jsx("polyline",{points:"17 6 23 6 23 12"})]});export{se as default};
