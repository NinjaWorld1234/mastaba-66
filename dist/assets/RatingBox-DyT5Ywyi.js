import{d as y,r,a as R,b as k,f as c,j as e,U as C,M as S}from"./index-PO4O9_Fr.js";import{S as j}from"./star-DEkBOYX3.js";import{G as T}from"./globe-H-Auzyor.js";import{T as b}from"./trash-2-B1SjAVum.js";import{S as A}from"./send-DS51h8Hw.js";/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const D=[["path",{d:"M20 4v7a4 4 0 0 1-4 4H4",key:"6o5b7l"}],["path",{d:"m9 10-5 5 5 5",key:"1kshq7"}]],E=y("corner-down-left",D),L=()=>{const[m,f]=r.useState([]),[N,h]=r.useState(!0),[g,i]=r.useState(null),[d,x]=r.useState(""),{user:a}=R(),l=k(),n=r.useCallback(async()=>{h(!0);try{const s=await c.getRatings();f(s)}catch(s){console.error("Failed to load ratings",s)}finally{h(!1)}},[]);r.useEffect(()=>{n()},[n]);const p=async s=>{if(d.trim())try{await c.replyToRating(s,d),l.success("تم إضافة الرد بنجاح"),x(""),i(null),n()}catch{l.error("فشل في إضافة الرد")}},w=async s=>{if(window.confirm("هل أنت متأكد من حذف هذا التقييم؟"))try{await c.deleteRating(s),l.success("تم حذف التقييم"),n()}catch{l.error("فشل في الحذف")}},v=async s=>{if(window.confirm("هل أنت متأكد من حذف هذا الرد؟"))try{await c.deleteReply(s),l.success("تم حذف الرد"),n()}catch{l.error("فشل في الحذف")}};return N?e.jsx("div",{className:"animate-pulse space-y-4",children:[1,2].map(s=>e.jsx("div",{className:"h-32 bg-white/5 rounded-2xl"},s))}):e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("h3",{className:"text-xl font-bold text-white flex items-center gap-2",children:[e.jsx(j,{className:"w-5 h-5 text-amber-400 fill-amber-400"}),e.jsx("span",{children:"آراء وتقييمات الطلاب"})]})}),e.jsx("div",{className:"grid gap-6",children:m.length===0?e.jsx("div",{className:"glass-panel p-8 text-center rounded-2xl bg-white/5",children:e.jsx("p",{className:"text-gray-400",children:"لا توجد تقييمات حالياً"})}):m.map(s=>{var o;return e.jsxs("div",{className:"glass-panel p-6 rounded-2xl bg-white/5 border border-white/10 space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-emerald-500/20 flex items-center justify-center text-emerald-400 border border-emerald-500/30 overflow-hidden",children:s.userAvatar?e.jsx("img",{src:s.userAvatar,alt:s.userName,className:"w-full h-full object-cover"}):e.jsx(C,{className:"w-6 h-6"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-white font-bold",children:s.userName}),e.jsxs("div",{className:"flex items-center gap-2 text-gray-400 text-xs mt-0.5",children:[e.jsx("div",{className:"flex gap-0.5",children:[...Array(5)].map((t,u)=>e.jsx(j,{className:`w-3 h-3 ${u<s.rating?"fill-amber-400 text-amber-400":"text-gray-600"}`},u))}),e.jsx("span",{children:"•"}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(T,{className:"w-3 h-3 text-emerald-400"}),e.jsx("span",{children:s.userCountry||"المنصة"})]})]})]})]}),((a==null?void 0:a.role)==="admin"||(a==null?void 0:a.role)==="supervisor")&&e.jsx("button",{onClick:()=>w(s.id),className:"p-2 text-red-400 hover:bg-red-500/10 rounded-lg transition-colors border border-transparent hover:border-red-500/20",title:"حذف التقييم",children:e.jsx(b,{className:"w-4 h-4"})})]}),e.jsxs("p",{className:"text-gray-200 text-sm leading-relaxed bg-black/20 p-4 rounded-xl border border-white/5 italic",children:['"',s.comment,'"']}),e.jsxs("div",{className:"space-y-3 mr-4 border-r-2 border-white/5 pr-4",children:[(o=s.replies)==null?void 0:o.map(t=>e.jsxs("div",{className:"bg-white/5 p-4 rounded-xl relative group",children:[e.jsxs("div",{className:"flex justify-between items-start mb-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(E,{className:"w-3 h-3 text-emerald-400"}),e.jsx("span",{className:`text-[11px] font-black uppercase tracking-wider ${t.role==="admin"?"text-amber-400":t.role==="supervisor"?"text-emerald-400":"text-blue-400"}`,children:t.role==="admin"?"الإدارة":t.role==="supervisor"?"المشرف":"طالب"}),e.jsx("span",{className:"text-white text-xs font-bold",children:t.userName})]}),((a==null?void 0:a.role)==="admin"||(a==null?void 0:a.role)==="supervisor")&&e.jsx("button",{onClick:()=>v(t.id),className:"opacity-0 group-hover:opacity-100 p-1 text-red-400 hover:bg-red-500/10 rounded transition-all",children:e.jsx(b,{className:"w-3 h-3"})})]}),e.jsx("p",{className:"text-gray-300 text-xs",children:t.content})]},t.id)),g===s.id?e.jsxs("div",{className:"flex gap-2 animate-in slide-in-from-top-2 duration-300",children:[e.jsx("input",{autoFocus:!0,type:"text",value:d,onChange:t=>x(t.target.value),placeholder:"اكتب ردك هنا...",className:"flex-1 bg-black/40 border border-white/10 rounded-xl px-4 py-2 text-xs text-white focus:outline-none focus:border-emerald-500",onKeyDown:t=>t.key==="Enter"&&p(s.id)}),e.jsx("button",{onClick:()=>p(s.id),className:"p-2 bg-emerald-600 text-white rounded-xl hover:bg-emerald-500 shadow-lg shadow-emerald-900/20",children:e.jsx(A,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>{i(null),x("")},className:"px-3 text-xs text-gray-400 hover:text-white",children:"إلغاء"})]}):e.jsxs("button",{onClick:()=>i(s.id),className:"text-[11px] text-emerald-400 font-bold hover:text-emerald-300 flex items-center gap-1.5 transition-colors px-1",children:[e.jsx(S,{className:"w-3 h-3"}),e.jsx("span",{children:"إضافة رد"})]})]})]},s.id)})})]})},F=r.memo(L);export{F as R};
