const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/index-CZK59VbI.js","assets/index-DN1WE4tu.css"])))=>i.map(i=>d[i]);
import{c as J,f as be,r as c,_ as I,j as e,X as G,R as fe,S as ce,p as ve,u as we,b as H,m as se,k as ae,E as je}from"./index-CZK59VbI.js";import{V as ye,M as Ne}from"./video-C0Eu5MXd.js";import{a as re,C as Ce}from"./chevron-right-BBSbSRth.js";import{U as ke}from"./upload-Chda2AkA.js";import{P as K}from"./plus-2XAY1BQM.js";import{L as Se}from"./loader-circle-D-53ksgz.js";import{T as W}from"./trash-2-B8x8V-M6.js";import{H as Fe}from"./hard-drive-rDs0G6OW.js";import{C as X}from"./clock-DVVeJK1Y.js";import{C as Ee}from"./circle-check-CDbYvaI5.js";import{P as le}from"./play-CLxR7PWu.js";import{F as _e}from"./funnel-n1m85611.js";import{E as Ue}from"./eye-qYqIMAXM.js";import{S as oe}from"./square-pen-DyP3Y4Ne.js";import{I as Pe}from"./image-Dy1TTQTc.js";import{S as qe}from"./save-BUiXEVi2.js";/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Le=[["path",{d:"M6 22a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h8a2.4 2.4 0 0 1 1.704.706l3.588 3.588A2.4 2.4 0 0 1 20 8v12a2 2 0 0 1-2 2z",key:"1oefj6"}],["path",{d:"M14 2v5a1 1 0 0 0 1 1h5",key:"wfsgrz"}],["path",{d:"M15.033 13.44a.647.647 0 0 1 0 1.12l-4.065 2.352a.645.645 0 0 1-.968-.56v-4.704a.645.645 0 0 1 .967-.56z",key:"1tzo1f"}]],$e=J("file-play",Le);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ze=[["path",{d:"M12 10v6",key:"1bos4e"}],["path",{d:"M9 13h6",key:"1uhe8q"}],["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],Ie=J("folder-plus",ze);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const De=[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],ie=J("folder",De);/**
 * @license lucide-react v0.562.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Me=[["path",{d:"M13 21h8",key:"1jsn5i"}],["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],ne=J("pen-line",Me),Re=({isOpen:y,onClose:o,onSelect:N,onSelectMultiple:L,multiSelect:j=!1})=>{const v=be(),E=c.useRef(null),[w,D]=c.useState([]),[_,$]=c.useState([]),[u,a]=c.useState(""),[d,U]=c.useState(!1),[M,P]=c.useState({}),[R,T]=c.useState(null),[z,A]=c.useState(""),[g,C]=c.useState(new Set),[B,s]=c.useState(!1),[n,x]=c.useState(""),[i,m]=c.useState(null),[k,S]=c.useState(""),b=c.useCallback(async(t=u)=>{U(!0),T(null);try{const{api:r}=await I(async()=>{const{api:h}=await import("./index-CZK59VbI.js").then(p=>p.J);return{api:h}},__vite__mapDeps([0,1])),l=await r.r2.listFiles(t);D(l.files||[]),$(l.folders||[]),a(l.prefix||"")}catch(r){console.error("Error fetching R2 files:",r),T(r.message)}finally{U(!1)}},[u]);c.useEffect(()=>{y&&b("")},[y]);const Z=t=>{b(t)},de=()=>{if(!u)return;const t=u.split("/").filter(Boolean);t.pop();const r=t.length>0?t.join("/")+"/":"";b(r)},xe=()=>{const t=Y.map(r=>r.url);g.size===t.length?C(new Set):C(new Set([...Array.from(g),...t]))},Y=c.useMemo(()=>w.filter(t=>t.name.toLowerCase().includes(z.toLowerCase())),[w,z]),he=t=>{if(t===0)return"0 B";const r=1024,l=["B","KB","MB","GB","TB"],h=Math.floor(Math.log(t)/Math.log(r));return parseFloat((t/Math.pow(r,h)).toFixed(2))+" "+l[h]},ue=t=>new Date(t).toLocaleDateString("ar-EG",{year:"numeric",month:"short",day:"numeric"}),me=async t=>{const r=t.target.files;if(!r||r.length===0)return;const{api:l}=await I(async()=>{const{api:h}=await import("./index-CZK59VbI.js").then(p=>p.J);return{api:h}},__vite__mapDeps([0,1]));for(let h=0;h<r.length;h++){const p=r[h],Q=`${Date.now()}-${p.name}`;try{P(F=>({...F,[Q]:0}));const{uploadUrl:q}=await l.r2.getUploadUrl(u+p.name,p.type),f=new XMLHttpRequest;f.open("PUT",q,!0),f.setRequestHeader("Content-Type",p.type),f.upload.onprogress=F=>{if(F.lengthComputable){const O=Math.round(F.loaded/F.total*100);P(ge=>({...ge,[Q]:O}))}};const pe=new Promise((F,O)=>{f.onload=()=>f.status===200?F(f.response):O(new Error("Upload failed")),f.onerror=()=>O(new Error("Upload error"))});f.send(p),await pe,v.success(`تم رفع ${p.name} بنجاح`)}catch(q){console.error("Upload error:",q),v.error(`فشل رفع ${p.name}: ${q.message}`)}finally{P(q=>{const f={...q};return delete f[Q],f})}}b(),E.current&&(E.current.value="")},ee=async(t,r)=>{if(window.confirm(`هل أنت متأكد من حذف "${r}"؟`))try{const{api:l}=await I(async()=>{const{api:h}=await import("./index-CZK59VbI.js").then(p=>p.J);return{api:h}},__vite__mapDeps([0,1]));await l.r2.deleteFile(t),v.success("تم الحذف بنجاح"),b()}catch(l){v.error(`فشل الحذف: ${l.message}`)}},V=async()=>{if(!(!i||!k.trim()))try{const{api:t}=await I(async()=>{const{api:h}=await import("./index-CZK59VbI.js").then(p=>p.J);return{api:h}},__vite__mapDeps([0,1])),r=i.key,l=u+k.trim()+(i.isFolder?"/":"");await t.r2.renameFile(r,l),v.success("تمت إعادة التسمية بنجاح"),m(null),b()}catch(t){v.error(`فشل إعادة التسمية: ${t.message}`)}},te=async()=>{if(n.trim())try{const{api:t}=await I(async()=>{const{api:r}=await import("./index-CZK59VbI.js").then(l=>l.J);return{api:r}},__vite__mapDeps([0,1]));await t.r2.createFolder(u+n.trim()+"/"),v.success("تم إنشاء المجلد بنجاح"),s(!1),x(""),b()}catch(t){v.error(`فشل إنشاء المجلد: ${t.message}`)}};return y?e.jsx("div",{className:"fixed inset-0 z-[60] flex items-center justify-center p-4 bg-black/90 backdrop-blur-md animate-fade-in",onClick:t=>t.target===t.currentTarget&&o(),children:e.jsxs("div",{className:"bg-[#0f172a] border border-white/10 rounded-[2rem] w-full max-w-4xl max-h-[85vh] overflow-hidden flex flex-col shadow-2xl relative",onClick:t=>t.stopPropagation(),children:[e.jsxs("div",{className:"p-6 border-b border-white/5 flex justify-between items-center bg-white/[0.02]",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-xl bg-violet-500/20 flex items-center justify-center",children:e.jsx(ye,{className:"w-5 h-5 text-violet-400"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-white",children:"متصفح ملفات R2"}),e.jsx("p",{className:"text-xs text-gray-400",children:"تصفح المجلدات واختر المحتوى"})]})]}),e.jsx("button",{onClick:o,className:"p-2 rounded-full hover:bg-white/10 text-gray-400 hover:text-white transition-all shadow-inner",children:e.jsx(G,{className:"w-6 h-6"})})]}),e.jsxs("div",{className:"px-6 py-3 bg-white/[0.01] border-b border-white/5 flex items-center gap-2 overflow-x-auto whitespace-nowrap scrollbar-hide",children:[e.jsx("button",{onClick:()=>b(""),className:`text-sm ${u?"text-gray-400 hover:text-white":"text-violet-400 font-bold"}`,children:"الرئيسية"}),u.split("/").filter(Boolean).map((t,r,l)=>e.jsxs(fe.Fragment,{children:[e.jsx(re,{className:"w-4 h-4 text-gray-600 rtl:rotate-0 rotate-180"}),e.jsx("button",{onClick:()=>b(l.slice(0,r+1).join("/")+"/"),className:`text-sm ${r===l.length-1?"text-violet-400 font-bold":"text-gray-400 hover:text-white"}`,children:t})]},r))]}),e.jsxs("div",{className:"p-4 bg-white/[0.01] border-b border-white/5 flex flex-wrap gap-3",children:[e.jsxs("div",{className:"flex-1 min-w-[200px] relative",children:[e.jsx(ce,{className:"absolute right-4 top-1/2 -translate-y-1/2 w-4 h-4 text-gray-500"}),e.jsx("input",{type:"text",placeholder:"ابحث في هذا المجلد...",value:z,onChange:t=>A(t.target.value),className:"w-full bg-black/40 border border-white/10 rounded-xl py-2.5 pr-11 pl-4 text-white placeholder-gray-500 focus:outline-none focus:border-violet-500 transition-colors text-sm"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"file",ref:E,onChange:me,className:"hidden",multiple:!0}),e.jsx("button",{onClick:()=>{var t;return(t=E.current)==null?void 0:t.click()},className:"p-2.5 rounded-xl bg-violet-600/20 text-violet-400 border border-violet-500/30 hover:bg-violet-600/30 transition-all",title:"رفع ملفات",children:e.jsx(ke,{className:"w-5 h-5"})}),e.jsx("button",{onClick:()=>s(!0),className:"p-2.5 rounded-xl bg-amber-600/20 text-amber-400 border border-amber-500/30 hover:bg-amber-600/30 transition-all",title:"مجلد جديد",children:e.jsx(Ie,{className:"w-5 h-5"})}),u&&e.jsx("button",{onClick:de,className:"p-2.5 rounded-xl bg-white/5 border border-white/10 text-gray-400 hover:text-white hover:bg-white/10 transition-all",title:"المجلد السابق",children:e.jsx(Ce,{className:"w-5 h-5 rtl:rotate-0 rotate-180"})}),e.jsx("button",{onClick:()=>b(),disabled:d,className:"p-2.5 rounded-xl bg-white/5 border border-white/10 text-gray-400 hover:text-white hover:bg-white/10 transition-all disabled:opacity-50",title:"تحديث",children:e.jsx(ve,{className:`w-5 h-5 ${d?"animate-spin":""}`})}),j&&w.length>0&&e.jsxs("button",{onClick:xe,className:"px-4 py-2.5 rounded-xl bg-emerald-600/20 text-emerald-400 border border-emerald-500/30 hover:bg-emerald-600/30 transition-all text-sm font-bold flex items-center gap-2",children:[e.jsx(K,{className:"w-4 h-4"}),e.jsx("span",{children:g.size===w.length?"إلغاء تحديد الكل":"تحديد كل المجلد"})]}),j&&g.size>0&&e.jsx("button",{onClick:()=>{L==null||L(Array.from(g)),o()},className:"px-6 py-2.5 rounded-xl bg-violet-600 text-white font-bold hover:bg-violet-500 transition-all flex items-center gap-2 shadow-lg shadow-violet-600/20",children:e.jsxs("span",{children:["إضافة ",g.size," محاضرة"]})})]})]}),Object.keys(M).length>0&&e.jsx("div",{className:"px-6 py-2 bg-violet-500/10 border-b border-violet-500/20 flex flex-col gap-2",children:Object.entries(M).map(([t,r])=>e.jsxs("div",{className:"flex flex-col gap-1",children:[e.jsxs("div",{className:"flex justify-between text-[10px] text-violet-300",children:[e.jsx("span",{className:"truncate max-w-[200px]",children:t.split("-").slice(1).join("-")}),e.jsxs("span",{children:[r,"%"]})]}),e.jsx("div",{className:"w-full h-1 bg-black/40 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-violet-500 transition-all duration-300",style:{width:`${r}%`}})})]},t))}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4 custom-scrollbar min-h-[400px]",children:d?e.jsxs("div",{className:"h-full flex flex-col items-center justify-center gap-4 py-20 text-gray-400",children:[e.jsx(Se,{className:"w-10 h-10 animate-spin text-violet-500"}),e.jsx("p",{className:"animate-pulse",children:"جاري جلب الملفات..."})]}):R?e.jsxs("div",{className:"h-full flex flex-col items-center justify-center gap-4 py-20 text-center",children:[e.jsx("div",{className:"w-16 h-16 rounded-full bg-red-500/10 flex items-center justify-center mb-2",children:e.jsx(G,{className:"w-8 h-8 text-red-500"})}),e.jsx("h4",{className:"text-lg font-bold text-white",children:"خطأ في الاتصال بالسيرفر"}),e.jsx("p",{className:"text-gray-400 max-w-md",children:R}),e.jsx("button",{onClick:()=>b(),className:"mt-4 px-6 py-2 rounded-xl bg-violet-600 text-white",children:"تحديث"})]}):e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-2 gap-4",children:[B&&e.jsxs("div",{className:"glass-panel p-4 rounded-2xl border border-amber-500/50 bg-amber-500/5 flex gap-4 animate-in slide-in-from-top-2 duration-300",children:[e.jsx("div",{className:"w-14 h-14 rounded-xl bg-amber-500/20 flex items-center justify-center flex-shrink-0",children:e.jsx(ie,{className:"w-7 h-7 text-amber-500"})}),e.jsxs("div",{className:"flex-1 flex flex-col gap-2",children:[e.jsx("input",{autoFocus:!0,type:"text",placeholder:"اسم المجلد الجديد...",value:n,onChange:t=>x(t.target.value),onKeyDown:t=>t.key==="Enter"&&te(),className:"bg-black/40 border border-white/10 rounded-lg px-3 py-1.5 text-sm text-white focus:outline-none focus:border-amber-500"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:te,className:"text-[10px] px-3 py-1 bg-amber-600 text-white rounded-md",children:"إنشاء"}),e.jsx("button",{onClick:()=>s(!1),className:"text-[10px] px-3 py-1 bg-white/5 text-gray-400 rounded-md",children:"إلغاء"})]})]})]}),_.map((t,r)=>e.jsxs("div",{className:"group glass-panel p-4 rounded-2xl transition-all flex gap-4 border border-white/5 hover:border-violet-500/50 bg-white/[0.02] relative",children:[e.jsx("div",{onClick:()=>Z(t.path),className:"w-14 h-14 rounded-xl bg-amber-500/10 flex items-center justify-center flex-shrink-0 group-hover:bg-amber-500/20 transition-colors cursor-pointer",children:e.jsx(ie,{className:"w-7 h-7 text-amber-500"})}),e.jsx("div",{className:"flex-1 min-w-0 flex flex-col justify-center cursor-pointer",onClick:()=>Z(t.path),children:(i==null?void 0:i.key)===t.path?e.jsx("input",{autoFocus:!0,className:"bg-black/60 border border-violet-500 rounded px-2 py-1 text-sm text-white",value:k,onChange:l=>S(l.target.value),onBlur:V,onKeyDown:l=>l.key==="Enter"&&V(),onClick:l=>l.stopPropagation()}):e.jsx("h4",{className:"font-bold text-white truncate text-sm",title:t.name,children:t.name.split("/").filter(Boolean).pop()})}),e.jsxs("div",{className:"flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[e.jsx("button",{onClick:l=>{l.stopPropagation();const h=t.name.split("/").filter(Boolean).pop()||"";m({key:t.path,name:h,isFolder:!0}),S(h)},className:"p-1.5 rounded-lg hover:bg-white/10 text-gray-400 hover:text-violet-400",children:e.jsx(ne,{className:"w-4 h-4"})}),e.jsx("button",{onClick:l=>{l.stopPropagation(),ee(t.path,t.name)},className:"p-1.5 rounded-lg hover:bg-white/10 text-gray-400 hover:text-red-400",children:e.jsx(W,{className:"w-4 h-4"})})]}),e.jsx("div",{className:"flex items-center text-gray-400 group-hover:text-white transition-colors ml-1",children:e.jsx(re,{className:"w-4 h-4 rtl:rotate-0 rotate-180"})})]},`folder-${r}`)),Y.map(t=>e.jsxs("div",{className:`group glass-panel p-4 rounded-2xl transition-all flex gap-4 overflow-hidden relative border bg-white/[0.02] ${g.has(t.url)?"border-violet-500 bg-violet-500/5":"border-white/5 hover:border-violet-500/50"}`,children:[e.jsx("div",{onClick:()=>{j?C(r=>{const l=new Set(r);return l.has(t.url)?l.delete(t.url):l.add(t.url),new Set(l)}):(N(t.url),o())},className:"w-14 h-14 rounded-xl bg-violet-500/10 flex items-center justify-center flex-shrink-0 group-hover:bg-violet-500/20 transition-colors cursor-pointer",children:t.fullName.toLowerCase().endsWith(".mp3")||t.fullName.toLowerCase().endsWith(".wav")?e.jsx(Ne,{className:"w-7 h-7 text-violet-400"}):e.jsx($e,{className:"w-7 h-7 text-violet-400"})}),e.jsxs("div",{className:"flex-1 min-w-0 pr-1 flex flex-col justify-center cursor-pointer",onClick:()=>{j?C(r=>{const l=new Set(r);return l.has(t.url)?l.delete(t.url):l.add(t.url),new Set(l)}):(N(t.url),o())},children:[(i==null?void 0:i.key)===t.fullName?e.jsx("input",{autoFocus:!0,className:"bg-black/60 border border-violet-500 rounded px-2 py-1 text-sm text-white mb-1",value:k,onChange:r=>S(r.target.value),onBlur:V,onKeyDown:r=>r.key==="Enter"&&V(),onClick:r=>r.stopPropagation()}):e.jsx("h4",{className:"font-bold text-white truncate text-sm mb-1",title:t.name,children:t.name}),e.jsxs("div",{className:"flex items-center gap-3 text-[10px] text-gray-500",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(Fe,{className:"w-3 h-3"}),he(t.size)]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(X,{className:"w-3 h-3"}),ue(t.lastModified)]})]})]}),e.jsxs("div",{className:"flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[e.jsx("button",{onClick:r=>{r.stopPropagation(),m({key:t.fullName,name:t.name,isFolder:!1}),S(t.name)},className:"p-1.5 rounded-lg hover:bg-white/10 text-gray-400 hover:text-violet-400",children:e.jsx(ne,{className:"w-4 h-4"})}),e.jsx("button",{onClick:r=>{r.stopPropagation(),ee(t.fullName,t.name)},className:"p-1.5 rounded-lg hover:bg-white/10 text-gray-400 hover:text-red-400",children:e.jsx(W,{className:"w-4 h-4"})})]}),e.jsx("div",{className:`ml-2 transition-opacity ${g.has(t.url)?"opacity-100":"opacity-0 group-hover:opacity-100"}`,children:e.jsx(Ee,{className:`w-5 h-5 ${g.has(t.url)?"text-violet-500":"text-emerald-500"}`})})]},t.id))]})}),e.jsx("div",{className:"p-4 border-t border-white/5 text-center bg-black/40",children:e.jsx("p",{className:"text-[10px] text-gray-500",children:u?`المجلد الحالي: ${u}`:"تصفح الملفات المرفوعة على R2"})})]})}):null},st=({onPreview:y})=>{var C,B;const{t:o}=we(),[N,L]=c.useState([]),[j,v]=c.useState(""),[E,w]=c.useState(!1),[D,_]=c.useState(!1),[$,u]=c.useState(null),[a,d]=c.useState({title:"",instructor:"",duration:"",category:"Quran",status:"published",passingScore:80,quizFrequency:3,thumbnail:"https://images.unsplash.com/photo-1542816417-0983c9c9ad53?w=400&h=225&fit=crop"});c.useEffect(()=>{U()},[]);const U=async()=>{const s=await H.getCourses();L(s)},M=s=>{v(s.target.value)},P=N.filter(s=>s.title.toLowerCase().includes(j.toLowerCase())||s.instructor.toLowerCase().includes(j.toLowerCase())),R=async s=>{if(window.confirm("هل أنت متأكد من حذف هذه الدورة؟"))try{await H.deleteCourse(s),U()}catch(n){console.error("Failed to delete course:",n),alert(`فشل الحذف: ${n.message}`)}},T=s=>{u(s.id),d({title:s.title,instructor:s.instructor,duration:s.duration,category:s.category,status:"published",thumbnail:s.thumbnail,videoUrl:s.videoUrl,passingScore:s.passingScore||80,quizFrequency:s.quizFrequency||0,episodes:s.episodes||[]}),w(!0)},z=async s=>{var n;s.preventDefault();try{if($)await H.updateCourse($,{title:a.title,instructor:a.instructor,duration:a.duration,category:a.category,thumbnail:a.thumbnail,videoUrl:a.videoUrl,episodes:a.episodes,passingScore:a.passingScore,quizFrequency:a.quizFrequency});else{const x={id:Date.now().toString(),title:a.title||"Untitled",titleEn:a.title||"Untitled",instructor:a.instructor||"Unknown",instructorEn:a.instructor||"Unknown",progress:0,category:a.category||"General",categoryEn:a.category||"General",duration:a.duration||"0h",durationEn:a.duration||"0h",thumbnail:a.thumbnail||"",description:"New Course Description",descriptionEn:"New Course Description",lessonsCount:((n=a.episodes)==null?void 0:n.length)||0,studentsCount:0,videoUrl:a.videoUrl,episodes:a.episodes||[],passingScore:a.passingScore||80,quizFrequency:a.quizFrequency||0};await H.addCourse(x)}U(),w(!1),u(null),d({title:"",instructor:"",duration:"",category:"Quran",status:"published",thumbnail:"https://images.unsplash.com/photo-1542816417-0983c9c9ad53?w=400&h=225&fit=crop",videoUrl:""})}catch(x){console.error("Failed to save course:",x),alert(`حدث خطأ أثناء حفظ الدورة: ${x.message}`)}},A=()=>{u(null),d({title:"",instructor:"",duration:"",category:"Quran",status:"published",thumbnail:"https://images.unsplash.com/photo-1542816417-0983c9c9ad53?w=400&h=225&fit=crop",videoUrl:"",passingScore:80,quizFrequency:3}),w(!0)},g=[{label:o("admin.totalCourses"),value:N.length.toString(),icon:se,color:"from-violet-500 to-purple-600"},{label:o("admin.publishedEpisodes"),value:N.reduce((s,n)=>s+(n.lessonsCount||0),0).toString(),icon:le,color:"from-emerald-500 to-teal-600"},{label:o("admin.totalHours"),value:"230",icon:X,color:"from-blue-500 to-cyan-600"},{label:o("admin.totalListeners"),value:N.reduce((s,n)=>s+(n.studentsCount||0),0).toString(),icon:ae,color:"from-amber-500 to-orange-600"}];return e.jsxs("div",{className:"animate-fade-in space-y-6 relative",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-bold text-white mb-2",children:o("admin.audioCourses")}),e.jsx("p",{className:"text-gray-300",children:o("courses.subtitle")})]}),e.jsxs("button",{onClick:A,className:"px-6 py-3 bg-gradient-to-r from-violet-500 to-purple-600 text-white rounded-xl font-bold hover:opacity-90 transition-opacity shadow-lg flex items-center gap-2",children:[e.jsx(K,{className:"w-5 h-5"}),e.jsx("span",{children:o("admin.addCourse")})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:g.map((s,n)=>e.jsx("div",{className:"glass-panel p-5 rounded-2xl",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:`w-12 h-12 rounded-xl bg-gradient-to-br ${s.color} flex items-center justify-center`,children:e.jsx(s.icon,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-400 text-sm",children:s.label}),e.jsx("p",{className:"text-2xl font-bold text-white",children:s.value})]})]})},n))}),e.jsxs("div",{className:"glass-panel p-4 rounded-2xl flex flex-col md:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(ce,{className:"absolute right-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"text",value:j,onChange:M,placeholder:o("admin.searchPlaceholder"),className:"w-full bg-white/5 border border-white/10 rounded-xl py-3 pr-12 pl-4 text-white placeholder-gray-400 focus:outline-none focus:border-violet-500"})]}),e.jsxs("select",{className:"px-6 py-3 bg-white/5 border border-white/10 rounded-xl text-white focus:outline-none focus:border-violet-500",children:[e.jsx("option",{value:"",children:o("admin.allStatuses")}),e.jsx("option",{value:"published",children:o("admin.published")}),e.jsx("option",{value:"draft",children:o("admin.draft")})]}),e.jsxs("button",{className:"px-6 py-3 bg-white/5 border border-white/10 rounded-xl text-white flex items-center gap-2 hover:bg-white/10 transition-colors",children:[e.jsx(_e,{className:"w-5 h-5"}),e.jsx("span",{children:o("admin.filter")})]})]}),e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:P.length>0?P.map(s=>e.jsx("div",{className:"glass-panel p-0 rounded-2xl overflow-hidden hover:border-violet-500/50 transition-all group",children:e.jsxs("div",{className:"flex",children:[e.jsxs("div",{className:"w-32 h-32 flex-shrink-0 relative",children:[e.jsx("img",{src:s.thumbnail,alt:s.title,className:"w-full h-full object-cover"}),e.jsx("div",{className:"absolute inset-0 bg-black/50 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx("div",{className:"w-12 h-12 rounded-full bg-violet-500 flex items-center justify-center",children:e.jsx(le,{className:"w-6 h-6 text-white"})})})]}),e.jsxs("div",{className:"flex-1 p-4 flex flex-col justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsx("h3",{className:"font-bold text-white text-lg",children:s.title}),e.jsx("span",{className:"px-2 py-1 rounded-full text-xs font-medium bg-emerald-500/20 text-emerald-400",children:o("admin.published")})]}),e.jsx("p",{className:"text-gray-400 text-sm mb-2",children:s.instructor})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-300",children:[e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(se,{className:"w-4 h-4"}),s.lessonsCount]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(X,{className:"w-4 h-4"}),s.duration]}),e.jsxs("span",{className:"flex items-center gap-1",children:[e.jsx(ae,{className:"w-4 h-4"}),s.studentsCount]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("button",{onClick:()=>y==null?void 0:y(s),className:"p-2 rounded-lg bg-white/5 hover:bg-emerald-500/20 text-gray-300 hover:text-emerald-400 transition-colors",title:"معاينة الدورة",children:e.jsx(Ue,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>T(s),className:"p-2 rounded-lg bg-white/5 hover:bg-blue-500/20 text-gray-300 hover:text-blue-400 transition-colors",children:e.jsx(oe,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>R(s.id),className:"p-2 rounded-lg bg-white/5 hover:bg-red-500/20 text-gray-300 hover:text-red-400 transition-colors",children:e.jsx(W,{className:"w-4 h-4"})})]})]})]})]})},s.id)):e.jsx("div",{className:"col-span-2 text-center py-10 text-gray-400",children:"No courses found matching your search."})}),e.jsx("div",{onClick:A,className:"glass-panel p-8 rounded-2xl border-2 border-dashed border-white/20 hover:border-violet-500/50 transition-colors cursor-pointer group",children:e.jsxs("div",{className:"flex flex-col items-center justify-center text-center",children:[e.jsx("div",{className:"w-16 h-16 rounded-full bg-violet-500/20 flex items-center justify-center mb-4 group-hover:bg-violet-500/30 transition-colors",children:e.jsx(K,{className:"w-8 h-8 text-violet-400"})}),e.jsx("h3",{className:"text-xl font-bold text-white mb-2",children:o("admin.addCourse")}),e.jsx("p",{className:"text-gray-400",children:o("admin.clickToAdd")})]})}),E&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/80 backdrop-blur-sm animate-fade-in",children:e.jsxs("div",{className:"bg-gray-900 border border-white/10 rounded-2xl w-full max-w-2xl overflow-hidden glass-panel",children:[e.jsxs("div",{className:"flex justify-between items-center p-6 border-b border-white/10",children:[e.jsx("h3",{className:"text-2xl font-bold text-white",children:$?"تحرير الدورة":o("admin.addCourse")}),e.jsx("button",{onClick:()=>w(!1),className:"text-gray-400 hover:text-white",children:e.jsx(G,{className:"w-6 h-6"})})]}),e.jsxs("form",{onSubmit:z,className:"p-6 space-y-6 overflow-y-auto max-h-[calc(100vh-200px)] custom-scrollbar",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4",children:[e.jsxs("section",{className:"space-y-4",children:[e.jsx("h4",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider mb-2",children:"المعلومات الأساسية"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm text-gray-300",children:o("admin.title")}),e.jsx("input",{required:!0,value:a.title,onChange:s=>d({...a,title:s.target.value}),className:"w-full bg-black/40 border border-white/10 rounded-xl p-3 text-white focus:border-violet-500 focus:outline-none transition-all",placeholder:"مثال: فقه الطهارة"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm text-gray-300",children:o("admin.instructor")}),e.jsx("input",{required:!0,value:a.instructor,onChange:s=>d({...a,instructor:s.target.value}),className:"w-full bg-black/40 border border-white/10 rounded-xl p-3 text-white focus:border-violet-500 focus:outline-none transition-all",placeholder:"مثال: الشيخ أحمد"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm text-gray-300",children:o("admin.duration")}),e.jsx("input",{value:a.duration,onChange:s=>d({...a,duration:s.target.value}),className:"w-full bg-black/40 border border-white/10 rounded-xl p-3 text-white focus:border-violet-500 focus:outline-none transition-all placeholder:text-gray-600",placeholder:"5h 30m"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm text-gray-300",children:o("admin.category")}),e.jsxs("select",{value:a.category,onChange:s=>d({...a,category:s.target.value}),className:"w-full bg-black/40 border border-white/10 rounded-xl p-3 text-white focus:border-violet-500 focus:outline-none transition-all",children:[e.jsx("option",{value:"Fiqh",children:"الفقه"}),e.jsx("option",{value:"Quran",children:"القرآن"}),e.jsx("option",{value:"History",children:"التاريخ"}),e.jsx("option",{value:"Ethics",children:"الأخلاق"})]})]})]})]}),e.jsxs("section",{className:"space-y-4",children:[e.jsx("h4",{className:"text-xs font-bold text-gray-500 uppercase tracking-wider mb-2",children:"إعدادات العرض والأداء"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm text-gray-300",children:o("admin.thumbnail")}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{value:a.thumbnail,onChange:s=>d({...a,thumbnail:s.target.value}),className:"flex-1 bg-black/40 border border-white/10 rounded-xl p-3 text-white focus:border-violet-500 focus:outline-none text-xs font-mono transition-all",placeholder:"https://..."}),e.jsx("div",{className:"w-12 h-12 rounded-lg bg-black/40 border border-white/10 flex items-center justify-center overflow-hidden flex-shrink-0",children:a.thumbnail?e.jsx("img",{src:a.thumbnail,className:"w-full h-full object-cover"}):e.jsx(Pe,{className:"w-5 h-5 text-gray-500"})})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm text-gray-300",children:"درجة النجاح"}),e.jsx("input",{type:"number",value:a.passingScore,onChange:s=>d({...a,passingScore:parseInt(s.target.value)}),className:"w-full bg-black/40 border border-white/10 rounded-xl p-3 text-white focus:border-violet-500 focus:outline-none transition-all",min:"0",max:"100"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm text-gray-300",children:"تكرار الاختبار"}),e.jsx("input",{type:"number",value:a.quizFrequency,onChange:s=>d({...a,quizFrequency:parseInt(s.target.value)}),className:"w-full bg-black/40 border border-white/10 rounded-xl p-3 text-white focus:border-violet-500 focus:outline-none transition-all",min:"0"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm text-gray-300",children:"الحالة"}),e.jsxs("select",{value:a.status,onChange:s=>d({...a,status:s.target.value}),className:"w-full bg-black/40 border border-white/10 rounded-xl p-3 text-white focus:border-violet-500 focus:outline-none transition-all",children:[e.jsx("option",{value:"published",children:"منشور"}),e.jsx("option",{value:"draft",children:"مسودة"})]})]})]})]}),e.jsxs("div",{className:"space-y-4 border-t border-white/5 pt-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-1",children:[e.jsxs("div",{children:[e.jsxs("h4",{className:"text-sm font-bold text-violet-400",children:["محاضرات الدورة (",((C=a.episodes)==null?void 0:C.length)||0,")"]}),e.jsx("p",{className:"text-[10px] text-gray-500 italic",children:"انقر على الاسم للتعديل"})]}),e.jsxs("button",{type:"button",onClick:()=>_(!0),className:"text-xs px-4 py-2 bg-violet-600 hover:bg-violet-500 text-white rounded-xl shadow-lg shadow-violet-600/20 transition-all flex items-center gap-2",children:[e.jsx(K,{className:"w-4 h-4"}),e.jsx("span",{children:"إضافة محاضرات"})]})]}),e.jsxs("div",{className:"space-y-2 max-h-[300px] overflow-y-auto custom-scrollbar pr-1",children:[(B=a.episodes)==null?void 0:B.map((s,n)=>e.jsxs("div",{className:"flex gap-3 items-center bg-white/[0.03] p-3 rounded-xl border border-white/5 group hover:border-violet-500/40 hover:bg-white/[0.05] transition-all focus-within:border-violet-500/60 focus-within:bg-violet-500/5",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-black/40 flex items-center justify-center text-xs text-gray-400 font-bold font-mono group-focus-within:text-violet-400 transition-colors",children:String(n+1).padStart(2,"0")}),e.jsxs("div",{className:"flex-1 flex items-center gap-3",children:[e.jsx(oe,{className:"w-4 h-4 text-gray-600 group-hover:text-violet-400 group-focus-within:animate-pulse transition-colors"}),e.jsx("input",{className:"flex-1 bg-transparent border-none text-sm text-white focus:outline-none placeholder:text-gray-700 font-medium",value:s.title,onChange:x=>{const i=[...a.episodes||[]];i[n].title=x.target.value,d({...a,episodes:i})},placeholder:"أدخل عنوان المحاضرة..."})]}),e.jsx("button",{type:"button",onClick:()=>{const x=(a.episodes||[]).filter((i,m)=>m!==n);d({...a,episodes:x})},className:"p-2 text-gray-500 hover:text-red-400 hover:bg-red-400/10 rounded-lg transition-all",children:e.jsx(G,{className:"w-4 h-4"})})]},n)),(!a.episodes||a.episodes.length===0)&&e.jsx("div",{className:"text-center py-10 border-2 border-dashed border-white/5 rounded-2xl text-gray-500 text-sm bg-white/[0.01]",children:"لم يتم إضافة أي محاضرات بعد. اضغط على الزر أعلاه للبدء."})]})]}),e.jsxs("div",{className:"pt-4 flex justify-end gap-3",children:[e.jsx("button",{type:"button",onClick:()=>w(!1),className:"px-6 py-3 rounded-xl border border-white/10 text-white hover:bg-white/5 transition-colors",children:o("admin.cancel")}),e.jsxs("button",{type:"submit",className:"px-6 py-3 rounded-xl bg-violet-600 hover:bg-violet-500 text-white font-bold shadow-lg shadow-violet-600/20 transition-colors flex items-center gap-2",children:[e.jsx(qe,{className:"w-5 h-5"}),e.jsx("span",{children:o("admin.save")})]})]})]})]})}),D&&e.jsx(je,{children:e.jsx(Re,{isOpen:D,onClose:()=>_(!1),multiSelect:!0,onSelect:s=>{var x,i;const n={id:Date.now().toString(),courseId:a.id||"",title:((x=s.split("/").pop())==null?void 0:x.replace(/%20/g," "))||"محاضرة جديدة",videoUrl:s,orderIndex:((i=a.episodes)==null?void 0:i.length)||0};d(m=>({...m,episodes:[...m.episodes||[],n],videoUrl:s})),_(!1)},onSelectMultiple:s=>{const n=s.map((i,m)=>{var k,S;return{id:(Date.now()+m).toString(),courseId:a.id||"",title:((k=i.split("/").pop())==null?void 0:k.replace(/%20/g," "))||`محاضرة ${m+1}`,videoUrl:i,orderIndex:(((S=a.episodes)==null?void 0:S.length)||0)+m}}),x=[...a.episodes||[],...n].sort((i,m)=>i.title.localeCompare(m.title,void 0,{numeric:!0,sensitivity:"base"}));x.forEach((i,m)=>i.orderIndex=m),d(i=>({...i,episodes:x,videoUrl:s[0]})),_(!1)}})})]})};export{st as default};
