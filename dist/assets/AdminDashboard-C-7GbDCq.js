import{r as d,R as y,b,j as e,B as C,i as S,D as $,T as w,m as R,k as L,n as A}from"./index-CZK59VbI.js";import{R as j}from"./constants-BK601W5v.js";import{P as D}from"./play-CLxR7PWu.js";import{R as z}from"./CategoricalChart-BSo9d02g.js";import{A as E,a as I}from"./AreaChart-CZ4eN20I.js";import{c as O,X as U,Y as W,T as K}from"./CartesianChart-CyMhDQ5h.js";import"./book-CTh-Cyma.js";const p=d.memo(({label:s,value:o,icon:a,color:c,trend:h,trendText:n,onClick:m})=>{const g=d.useCallback(l=>{(l.key==="Enter"||l.key===" ")&&(l.preventDefault(),m())},[m]),r={orange:{border:"border-orange-500/50",bg:"bg-orange-500/10",text:"text-orange-300",icon:"text-orange-500"},blue:{border:"border-blue-500/50",bg:"bg-blue-500/10",text:"text-blue-300",icon:"text-blue-500"},emerald:{border:"border-emerald-500/50",bg:"bg-emerald-500/10",text:"text-emerald-300",icon:"text-emerald-500"}},t=r[c]||r.emerald;return e.jsxs("article",{onClick:m,onKeyDown:g,className:"glass-panel p-1 rounded-3xl relative overflow-hidden group cursor-pointer",role:"button",tabIndex:0,"aria-label":`${s}: ${o}`,children:[e.jsx("div",{className:`absolute inset-0 bg-gradient-to-b from-${c}-500/10 to-transparent opacity-0 group-hover:opacity-100 transition-opacity`,"aria-hidden":"true"}),e.jsxs("div",{className:`bg-[#0a1815]/60 p-5 rounded-[1.3rem] h-full flex flex-col justify-between border-t ${t.border} relative z-10`,children:[c==="orange"&&e.jsx("div",{className:"absolute right-0 top-0 opacity-10","aria-hidden":"true",children:e.jsx(A,{className:"w-20 h-20 text-orange-500"})}),e.jsxs("div",{className:"flex justify-between items-start relative z-10",children:[e.jsxs("div",{children:[e.jsx("p",{className:`${t.text} text-[10px] font-bold uppercase tracking-wider mb-1`,children:s}),e.jsx("h3",{className:"text-3xl font-extrabold text-white",children:o})]}),e.jsx("div",{className:`w-10 h-10 rounded-lg rotate-3 ${t.bg} border border-${c}-500/20 flex items-center justify-center ${t.icon} shadow-sm`,"aria-hidden":"true",children:e.jsx(a,{className:"w-5 h-5 -rotate-3"})})]}),h&&e.jsxs("div",{className:"flex items-center gap-2 mt-3 pt-3 border-t border-white/5 relative z-10",children:[e.jsxs("span",{className:`${t.bg} ${t.text.replace("300","400")} text-[9px] font-bold px-1.5 py-0.5 rounded-full flex items-center gap-1`,children:[e.jsx(w,{className:"w-2.5 h-2.5","aria-hidden":"true"}),h]}),e.jsx("span",{className:"text-[10px] text-gray-500",children:n})]})]})]})});p.displayName="StatCard";const N=d.memo(({activity:s,isLast:o})=>{const a={success:"bg-emerald-500",warning:"bg-red-500",info:"bg-blue-500"};return e.jsxs("article",{className:`relative pl-5 pb-5 ${o?"pb-0":""} border-l ${o?"border-0":"border-white/10"} group`,"aria-label":`${s.user}: ${s.action}`,children:[e.jsx("div",{className:"absolute -left-[6px] top-0 w-3 h-3 flex items-center justify-center","aria-hidden":"true",children:e.jsx("div",{className:`w-2 h-2 rotate-45 ${a[s.type]}`})}),e.jsxs("div",{className:"bg-white/5 p-3 rounded-xl hover:bg-white/10 transition-colors cursor-pointer border border-transparent hover:border-white/5",children:[e.jsxs("div",{className:"flex justify-between items-start mb-1",children:[e.jsx("h4",{className:"text-[11px] font-bold text-white",children:s.user}),e.jsx("time",{className:"text-[9px] text-gray-500",children:s.time})]}),e.jsx("p",{className:"text-[10px] text-gray-400 leading-relaxed",children:s.action})]})]})});N.displayName="ActivityItemCard";const M=d.memo(({setActiveTab:s,unreadCount:o})=>{const[a,c]=y.useState({totalStudents:0,activeCourses:0,completionRate:0,isLoading:!0});y.useEffect(()=>{(async()=>{try{const[t,l]=await Promise.all([b.getUsers(),b.getCourses()]),f=Array.isArray(t)?t.filter(x=>x.role==="student").length:0,u=Array.isArray(l)?l.filter(x=>x.status==="published").length:0,i=Array.isArray(t)?t.filter(x=>x.role==="student"):[],v=i.length>0?Math.round(i.reduce((x,k)=>x+(k.level||1)*10,0)/i.length):0;c({totalStudents:f,activeCourses:u,completionRate:Math.min(v,100),isLoading:!1})}catch(t){console.error("Failed to fetch stats:",t),c(l=>({...l,isLoading:!1}))}})()},[]);const h=d.useMemo(()=>[{name:"Week 1",hours:400},{name:"Week 2",hours:600},{name:"Week 3",hours:1400},{name:"Week 4",hours:2405},{name:"Week 5",hours:2100},{name:"Week 6",hours:3200}],[]),n=d.useCallback(r=>{s==null||s(r)},[s]),m=d.useCallback(async()=>{try{const[r,t]=await Promise.all([b.getUsers(),b.getCourses()]),l={generatedAt:new Date().toISOString(),usersCount:Array.isArray(r)?r.length:0,coursesCount:Array.isArray(t)?t.length:0,recentActivity:j,stats:{completionRate:`${a.completionRate}%`,activeCourses:a.activeCourses,totalStudents:a.totalStudents}},f=new Blob([JSON.stringify(l,null,2)],{type:"application/json"}),u=URL.createObjectURL(f),i=document.createElement("a");i.href=u,i.download=`dashboard-summary-${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(i),i.click(),document.body.removeChild(i),URL.revokeObjectURL(u)}catch(r){console.error("Failed to export summary",r)}},[a]),g=d.useMemo(()=>({backgroundColor:"#0a1815",borderColor:"rgba(255,255,255,0.1)",color:"#fff",borderRadius:"12px",boxShadow:"0 4px 20px rgba(0,0,0,0.5)",fontSize:"12px"}),[]);return e.jsxs("div",{className:"space-y-6 animate-fade-in pb-10",role:"main","aria-label":"لوحة التحكم",children:[o!==void 0&&o>0?e.jsxs("div",{onClick:()=>s==null?void 0:s("messages"),className:"bg-gradient-to-r from-emerald-600/20 to-teal-600/20 border border-emerald-500/30 p-4 rounded-2xl flex items-center justify-between cursor-pointer group hover:border-emerald-400/50 transition-all backdrop-blur-md relative z-30 mb-8",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 bg-emerald-500 rounded-xl flex items-center justify-center shadow-lg shadow-emerald-900/40 group-hover:scale-110 transition-transform",children:e.jsx(C,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-white font-bold text-sm",children:"لديك رسائل دعم جديدة!"}),e.jsxs("p",{className:"text-emerald-200/70 text-xs mt-0.5",children:["هناك ",o," رسائل لم يتم الرد عليها بعد."]})]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-emerald-300 text-xs font-bold bg-white/5 px-3 py-1.5 rounded-lg group-hover:bg-white/10 transition-colors",children:[e.jsx("span",{children:"انتقال للمحادثات"}),e.jsx(D,{className:"w-3 h-3 rotate-180"})]})]}):null,e.jsxs("header",{className:"flex justify-between items-end mb-6 relative",children:[e.jsx("div",{className:"absolute -left-20 -top-20 w-64 h-64 bg-emerald-500/10 rounded-full blur-[80px] pointer-events-none","aria-hidden":"true"}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-white mb-1 font-serif",children:"لوحة التحكم"}),e.jsxs("p",{className:"text-gray-400 text-xs flex items-center gap-2",children:[e.jsx("span",{className:"w-1.5 h-1.5 bg-emerald-500 rotate-45","aria-hidden":"true"}),"مرحباً بك في لوحة إدارة المنصة"]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("button",{className:"px-3 py-2 bg-[#0a1815] border border-white/10 hover:bg-white/5 rounded-lg text-xs text-gray-300 font-bold flex items-center gap-2 transition-colors","aria-label":"تحديد الفترة الزمنية",children:[e.jsx(S,{className:"w-3 h-3","aria-hidden":"true"}),"آخر 30 يوم"]}),e.jsxs("button",{onClick:m,className:"px-4 py-2 bg-emerald-600 hover:bg-emerald-500 rounded-lg text-xs text-white font-bold shadow-lg shadow-emerald-900/20 flex items-center gap-2 transition-colors border border-emerald-400/20 focus:outline-none focus:ring-2 focus:ring-emerald-400","aria-label":"تصدير تقرير لوحة التحكم",children:[e.jsx($,{className:"w-3 h-3","aria-hidden":"true"}),"تصدير التقرير"]})]})]}),e.jsxs("section",{className:"grid grid-cols-1 md:grid-cols-3 gap-5","aria-label":"إحصائيات سريعة",children:[e.jsx(p,{label:"نسبة الإكمال",value:a.isLoading?"...":`${a.completionRate}%`,icon:w,color:"orange",trend:"+5.6%",trendText:"مقارنة بالشهر الماضي",onClick:()=>n("reports")}),e.jsx(p,{label:"الدورات النشطة",value:a.isLoading?"...":a.activeCourses.toString(),icon:R,color:"blue",trend:"+2",trendText:"دورات جديدة",onClick:()=>n("audio-courses")}),e.jsx(p,{label:"إجمالي الطلاب",value:a.isLoading?"...":a.totalStudents.toLocaleString(),icon:L,color:"emerald",trend:"+12%",trendText:"زيادة ثابتة",onClick:()=>n("students")})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs("section",{onClick:()=>n("reports"),className:"lg:col-span-2 glass-panel p-6 rounded-3xl relative border-t-2 border-emerald-500/10 cursor-pointer group hover:bg-white/5 transition-colors",role:"button",tabIndex:0,onKeyDown:r=>(r.key==="Enter"||r.key===" ")&&n("reports"),"aria-label":"تحليل تفاعل الطلاب - اضغط للتفاصيل",children:[e.jsx("div",{className:"corner-ornament-complex corner-tr","aria-hidden":"true"}),e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-white mb-1 group-hover:text-emerald-400 transition-colors",children:"تحليل تفاعل الطلاب"}),e.jsx("p",{className:"text-[10px] text-gray-400",children:"ساعات الاستماع والمشاهدة الأسبوعية"})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("span",{className:"text-2xl font-bold text-white block",children:"2,405"}),e.jsx("span",{className:"text-emerald-400 text-[10px] font-bold",children:"إجمالي الساعات"})]})]}),e.jsx("div",{className:"h-64 w-full","aria-label":"رسم بياني لتفاعل الطلاب",children:e.jsx(z,{width:"100%",height:"100%",children:e.jsxs(E,{data:h,margin:{top:10,right:0,left:-20,bottom:0},children:[e.jsx("defs",{children:e.jsxs("linearGradient",{id:"colorHours",x1:"0",y1:"0",x2:"0",y2:"1",children:[e.jsx("stop",{offset:"5%",stopColor:"#10b981",stopOpacity:.3}),e.jsx("stop",{offset:"95%",stopColor:"#10b981",stopOpacity:0})]})}),e.jsx(O,{strokeDasharray:"3 3",vertical:!1,stroke:"#ffffff08"}),e.jsx(U,{dataKey:"name",stroke:"#6b7280",tick:{fill:"#9ca3af",fontSize:9},axisLine:!1,tickLine:!1,dy:10}),e.jsx(W,{stroke:"#6b7280",tick:{fill:"#9ca3af",fontSize:9},axisLine:!1,tickLine:!1}),e.jsx(K,{contentStyle:g,itemStyle:{color:"#10b981"}}),e.jsx(I,{type:"monotone",dataKey:"hours",stroke:"#10b981",strokeWidth:3,fillOpacity:1,fill:"url(#colorHours)"})]})})})]}),e.jsxs("section",{className:"glass-panel p-6 rounded-3xl flex flex-col relative overflow-hidden","aria-label":"النشاط المباشر",children:[e.jsx("div",{className:"mashrabiya-pattern absolute inset-0 opacity-5 pointer-events-none","aria-hidden":"true"}),e.jsxs("div",{className:"flex justify-between items-center mb-5 relative z-10",children:[e.jsx("h3",{className:"text-base font-bold text-white",children:"النشاط المباشر"}),e.jsx("div",{className:"w-1.5 h-1.5 rounded-full bg-emerald-500 animate-pulse","aria-label":"نشط الآن"})]}),e.jsx("div",{className:"space-y-1 flex-1 overflow-y-auto custom-scrollbar pr-2 relative z-10",role:"feed","aria-label":"قائمة الأنشطة الأخيرة",children:j.map((r,t)=>e.jsx(N,{activity:r,isLast:t===j.length-1},r.id))}),e.jsx("button",{onClick:()=>n("activity-log"),className:"w-full mt-3 py-2.5 rounded-xl border border-white/10 text-emerald-400 text-[10px] font-bold hover:bg-emerald-500/10 transition-colors relative z-10 focus:outline-none focus:ring-2 focus:ring-emerald-400","aria-label":"عرض سجل النشاط الكامل",children:"عرض السجل الكامل"})]})]})]})});M.displayName="AdminDashboard";export{M as default};
