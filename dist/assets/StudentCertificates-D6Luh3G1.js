const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/jspdf.es.min-jSkePDmX.js","assets/index-bJQP0_Bo.js","assets/index-IBsJdCD3.css"])))=>i.map(i=>d[i]);
import{a as F,f as $,r as o,b as f,j as e,A as g,C as O,D as G,_ as N}from"./index-bJQP0_Bo.js";import{L as v}from"./loader--M9QS-8M.js";import{L as B}from"./lock-C0dvzLJG.js";import{F as V}from"./file-text-CR02gez3.js";import{I as z}from"./image-CZ2O5mT1.js";const Q=()=>{const{user:i}=F(),l=$(),[d,u]=o.useState([]),[y,E]=o.useState([]),[T,R]=o.useState(!0),[x,m]=o.useState(null),[a,c]=o.useState(null);o.useEffect(()=>{I()},[]);const I=async()=>{try{const[t,s]=await Promise.all([f.getCertificates(),f.getCourses()]);u(t),E(s)}catch(t){console.error(t),l.error("ÙØ´Ù„ ÙÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª")}finally{R(!1)}},S=async t=>{m(t);try{const s=await f.generateCertificate(t);u(n=>[s,...n]),c(s),l.success("ØªÙ… Ø¥ØµØ¯Ø§Ø± Ø§Ù„Ø´Ù‡Ø§Ø¯Ø© Ø¨Ù†Ø¬Ø§Ø­")}catch(s){l.error(s.message||"ÙØ´Ù„ Ø¥ØµØ¯Ø§Ø± Ø§Ù„Ø´Ù‡Ø§Ø¯Ø©")}finally{m(null)}},A=async()=>{m("MASTER");try{const t=await f.generateMasterCertificate();u(s=>[t,...s]),c(t),l.success("ØªÙ… Ø¥ØµØ¯Ø§Ø± Ø§Ù„Ø´Ù‡Ø§Ø¯Ø© Ø§Ù„Ø¬Ø§Ù…Ø¹ÙŠØ© Ø¨Ù†Ø¬Ø§Ø­! ğŸ“")}catch(t){l.error(t.message||"ÙØ´Ù„ Ø¥ØµØ¯Ø§Ø± Ø§Ù„Ø´Ù‡Ø§Ø¯Ø© Ø§Ù„Ø¬Ø§Ù…Ø¹ÙŠØ©")}finally{m(null)}},D=async()=>{const t=document.getElementById("certificate-template");if(t)try{l.success("Ø¬Ø§Ø±ÙŠ ØªØ¬Ù‡ÙŠØ² Ù…Ù„Ù PDF...");const s=(await N(async()=>{const{default:w}=await import("./html2canvas.esm-QH1iLAAe.js");return{default:w}},[])).default,{jsPDF:n}=await N(async()=>{const{jsPDF:w}=await import("./jspdf.es.min-jSkePDmX.js").then(L=>L.j);return{jsPDF:w}},__vite__mapDeps([0,1,2])),r=await s(t,{scale:2,useCORS:!0,logging:!1,backgroundColor:"#ffffff"}),j=r.toDataURL("image/jpeg",1),_=new n({orientation:"landscape",unit:"px",format:[r.width,r.height]});_.addImage(j,"JPEG",0,0,r.width,r.height),_.save(`certificate-${a==null?void 0:a.courseId}.pdf`),l.success("ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø´Ù‡Ø§Ø¯Ø© Ø¨Ù†Ø¬Ø§Ø­")}catch(s){console.error("PDF download error:",s),l.error("Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ù…Ù„Ù")}},k=async()=>{const t=document.getElementById("certificate-template");if(t)try{l.success("Ø¬Ø§Ø±ÙŠ ØªØ¬Ù‡ÙŠØ² Ø§Ù„ØµÙˆØ±Ø©...");const s=(await N(async()=>{const{default:j}=await import("./html2canvas.esm-QH1iLAAe.js");return{default:j}},[])).default,n=await s(t,{scale:2,useCORS:!0,logging:!1,backgroundColor:"#ffffff"}),r=document.createElement("a");r.download=`certificate-${a==null?void 0:a.courseId}.jpg`,r.href=n.toDataURL("image/jpeg",1),r.click(),l.success("ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙˆØ±Ø© Ø¨Ù†Ø¬Ø§Ø­")}catch(s){console.error("Image download error:",s),l.error("Ø­Ø¯Ø« Ø®Ø·Ø£ Ø£Ø«Ù†Ø§Ø¡ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙˆØ±Ø©")}},p=Array.isArray(y)?y:[],C=p.filter(t=>{const s=d.some(r=>r.courseId===t.id);return t.progress===100&&!s}),b=p.filter(t=>t.progress===100).length,h=p.length,M=h>0&&b===h,P=d.some(t=>t.courseId==="MASTER_CERT");return T?e.jsx("div",{className:"flex justify-center p-10",children:e.jsx(v,{className:"animate-spin"})}):e.jsxs("div",{className:"animate-fade-in flex flex-col items-center pt-10 relative z-10 pb-20 px-4",children:[e.jsx("style",{children:`
                    @media print {
                        body * { visibility: hidden; }
                        #certificate-template, #certificate-template * { visibility: visible; }
                        #certificate-template {
                            position: fixed; left: 0; top: 0; width: 100%; height: 100%;
                            margin: 0; padding: 20px; background: white !important;
                            z-index: 9999; border: 10px double #d97706 !important;
                            -webkit-print-color-adjust: exact; print-color-adjust: exact;
                        }
                        .no-print { display: none !important; }
                    }
                `}),e.jsxs("div",{className:"text-center mb-8 no-print",children:[e.jsx("h2",{className:"text-3xl font-bold text-white mb-2",children:"Ø§Ù„Ø´Ù‡Ø§Ø¯Ø§Øª"}),e.jsx("p",{className:"text-gray-300 mb-4",children:"Ø¥Ø¯Ø§Ø±Ø© ÙˆØ¹Ø±Ø¶ Ø´Ù‡Ø§Ø¯Ø§ØªÙƒ Ø§Ù„Ù…ÙƒØªØ³Ø¨Ø©"}),e.jsx("button",{onClick:()=>{c({id:"sample",studentId:(i==null?void 0:i.id)||"sample-user",courseId:"sample-course",userName:(i==null?void 0:i.name)||"Ø£Ø­Ù…Ø¯ Ù…Ø­Ù…Ø¯",courseTitle:"Ù†Ù…ÙˆØ°Ø¬ Ø´Ù‡Ø§Ø¯Ø© Ù…Ø¹ØªÙ…Ø¯Ø©",issueDate:new Date().toISOString().split("T")[0],grade:"Excellent",code:"SAMPLE-123456"})},className:"text-sm text-gold-400 hover:text-gold-300 underline underline-offset-4",children:"Ø¹Ø±Ø¶ Ù†Ù…ÙˆØ°Ø¬ Ù„Ù„Ø´Ù‡Ø§Ø¯Ø©"})]}),!a&&e.jsxs("div",{className:"w-full max-w-4xl space-y-8 no-print",children:[!P&&e.jsxs("div",{className:"glass-panel p-6 rounded-2xl relative overflow-hidden border border-gold-500/30",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-16 h-16 bg-gold-500/20 rounded-full flex items-center justify-center",children:e.jsx(g,{className:"w-8 h-8 text-gold-400"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-white",children:"Ø§Ù„Ø´Ù‡Ø§Ø¯Ø© Ø§Ù„Ø¬Ø§Ù…Ø¹ÙŠØ© Ø§Ù„Ø´Ø§Ù…Ù„Ø©"}),e.jsxs("p",{className:"text-gray-400 text-sm mt-1",children:["ØªÙ…Ù†Ø­ Ø¹Ù†Ø¯ Ø¥ØªÙ…Ø§Ù… Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¯ÙˆØ±Ø§Øª (",b,"/",h,")"]})]})]}),M?e.jsxs("button",{onClick:A,disabled:x==="MASTER",className:"px-6 py-2 bg-gradient-to-r from-gold-600 to-amber-600 text-white rounded-xl font-bold hover:shadow-lg hover:shadow-gold-900/20 transition-all flex items-center gap-2",children:[x==="MASTER"?e.jsx(v,{className:"animate-spin w-5 h-5"}):e.jsx(g,{className:"w-5 h-5"}),e.jsx("span",{children:"Ø¥ØµØ¯Ø§Ø± Ø§Ù„Ø´Ù‡Ø§Ø¯Ø©"})]}):e.jsxs("div",{className:"flex items-center gap-2 text-gray-500 bg-black/20 px-4 py-2 rounded-lg border border-white/5",children:[e.jsx(B,{className:"w-4 h-4"}),e.jsx("span",{children:"ØºÙŠØ± Ù…ØªØ§Ø­ Ø¨Ø¹Ø¯"})]})]}),e.jsx("div",{className:"mt-4 w-full bg-black/30 h-2 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-gold-500 transition-all duration-1000",style:{width:`${b/h*100}%`}})})]}),C.length>0&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"text-white font-bold text-lg flex items-center gap-2",children:[e.jsx(O,{className:"w-5 h-5 text-emerald-400"}),"Ø¯ÙˆØ±Ø§Øª Ù…ÙƒØªÙ…Ù„Ø© (Ø¬Ø§Ù‡Ø²Ø© Ù„Ù„Ø¥ØµØ¯Ø§Ø±)"]}),e.jsx("div",{className:"grid gap-4",children:C.map(t=>e.jsxs("div",{className:"glass-panel p-4 flex items-center justify-between",children:[e.jsx("span",{className:"text-white font-medium",children:t.title}),e.jsx("button",{onClick:()=>S(t.id),disabled:x===t.id,className:"px-4 py-2 bg-emerald-600 hover:bg-emerald-500 text-white rounded-lg text-sm font-bold transition-colors flex items-center gap-2",children:x===t.id?e.jsx(v,{className:"animate-spin w-4 h-4"}):"Ø¥ØµØ¯Ø§Ø±"})]},t.id))})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h3",{className:"text-white font-bold text-lg",children:["Ø´Ù‡Ø§Ø¯Ø§ØªÙŠ (",d.length,")"]}),d.length===0?e.jsx("div",{className:"text-center py-10 text-gray-500",children:"Ù„Ø§ ØªÙˆØ¬Ø¯ Ø´Ù‡Ø§Ø¯Ø§Øª Ø­ØªÙ‰ Ø§Ù„Ø¢Ù†"}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:d.map(t=>e.jsx("div",{onClick:()=>c(t),className:`glass-panel p-5 cursor-pointer hover:border-emerald-500/50 transition-all group ${t.courseId==="MASTER_CERT"?"border-gold-500/30 bg-gold-900/10":""}`,children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:`w-12 h-12 rounded-full flex items-center justify-center ${t.courseId==="MASTER_CERT"?"bg-gold-500/20":"bg-emerald-500/20"}`,children:e.jsx(g,{className:`w-6 h-6 ${t.courseId==="MASTER_CERT"?"text-gold-400":"text-emerald-400"}`})}),e.jsxs("div",{children:[e.jsx("h4",{className:`font-bold ${t.courseId==="MASTER_CERT"?"text-gold-200":"text-white"}`,children:t.courseTitle}),e.jsxs("p",{className:"text-xs text-gray-400 mt-1",children:["ØªØ§Ø±ÙŠØ® Ø§Ù„Ø¥ØµØ¯Ø§Ø±: ",t.issueDate]})]})]})},t.id))})]})]}),a&&e.jsxs("div",{className:"animate-scale-in flex flex-col items-center w-full max-w-3xl",children:[e.jsx("button",{onClick:()=>c(null),className:"mb-4 text-gray-400 hover:text-white flex items-center gap-2 no-print self-start",children:"â† Ø§Ù„Ø¹ÙˆØ¯Ø© Ù„Ù„Ø´Ù‡Ø§Ø¯Ø§Øª"}),e.jsxs("div",{className:"glass-panel p-1 border-4 border-double border-gold-600/30 rounded-lg w-full bg-[#fffcf2] mb-8 relative group",children:[e.jsxs("div",{className:"flex flex-wrap gap-3 mb-6 justify-center w-full no-print",children:[e.jsxs("button",{onClick:D,className:"px-5 py-2.5 bg-red-600 hover:bg-red-700 text-white rounded-xl font-bold flex items-center gap-2 shadow-lg hover:shadow-red-900/20 transition-all",children:[e.jsx(V,{className:"w-5 h-5"}),e.jsx("span",{children:"ØªØ­Ù…ÙŠÙ„ PDF"})]}),e.jsxs("button",{onClick:k,className:"px-5 py-2.5 bg-blue-600 hover:bg-blue-700 text-white rounded-xl font-bold flex items-center gap-2 shadow-lg hover:shadow-blue-900/20 transition-all",children:[e.jsx(z,{className:"w-5 h-5"}),e.jsx("span",{children:"ØªØ­Ù…ÙŠÙ„ ØµÙˆØ±Ø©"})]}),e.jsxs("button",{onClick:()=>window.print(),className:"px-5 py-2.5 bg-gray-700 hover:bg-gray-600 text-white rounded-xl font-bold flex items-center gap-2 shadow-lg hover:shadow-gray-900/20 transition-all",children:[e.jsx(G,{className:"w-5 h-5"}),e.jsx("span",{children:"Ø·Ø¨Ø§Ø¹Ø©"})]})]}),e.jsxs("div",{id:"certificate-template",className:`border border-gray-300 p-10 flex flex-col items-center text-center relative overflow-hidden bg-white min-h-[600px] justify-center ${a.courseId==="MASTER_CERT"?"bg-amber-50/50":""}`,children:[e.jsx("div",{className:"absolute top-0 left-0 w-24 h-24 border-t-8 border-l-8 border-emerald-900 opacity-80"}),e.jsx("div",{className:"absolute top-0 right-0 w-24 h-24 border-t-8 border-r-8 border-emerald-900 opacity-80"}),e.jsx("div",{className:"absolute bottom-0 left-0 w-24 h-24 border-b-8 border-l-8 border-emerald-900 opacity-80"}),e.jsx("div",{className:"absolute bottom-0 right-0 w-24 h-24 border-b-8 border-r-8 border-emerald-900 opacity-80"}),e.jsx("div",{className:"w-20 h-20 mb-6 text-emerald-800",children:e.jsx(g,{className:"w-full h-full"})}),e.jsx("h2",{className:"text-5xl font-serif text-emerald-950 font-bold mb-4 tracking-wide",children:a.courseId==="MASTER_CERT"?"Ø§Ù„Ø´Ù‡Ø§Ø¯Ø© Ø§Ù„Ø¬Ø§Ù…Ø¹ÙŠØ©":"Ø´Ù‡Ø§Ø¯Ø© Ø¥ØªÙ…Ø§Ù…"}),e.jsx("h3",{className:"text-xl text-gold-600 font-medium mb-12",children:"Ø§Ù„Ù…ØµØ·Ø¨Ø© Ø§Ù„Ø¹Ù„Ù…ÙŠØ©"}),e.jsx("p",{className:"text-gray-600 mb-4 text-lg",children:"ØªØ´Ù‡Ø¯ Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ù†ØµØ© Ø¨Ø£Ù†"}),e.jsx("h1",{className:"text-4xl font-bold text-emerald-950 mb-6 underline decoration-gold-400 decoration-2 underline-offset-8 px-8 py-2",children:a.userName}),e.jsxs("p",{className:"text-gray-700 mb-12 max-w-lg leading-loose text-lg",children:[a.courseId==="MASTER_CERT"?e.jsxs(e.Fragment,{children:["Ù‚Ø¯ Ø£ØªÙ… Ø¨Ù†Ø¬Ø§Ø­ ",e.jsx("span",{className:"font-bold text-emerald-900",children:"ÙƒØ§ÙØ© Ø§Ù„Ø¯ÙˆØ±Ø§Øª Ø§Ù„ØªØ£Ø³ÙŠØ³ÙŠØ©"})," Ø§Ù„Ù…Ù‚Ø±Ø±Ø© ÙÙŠ Ø§Ù„Ù…Ù†Ù‡Ø¬ Ø§Ù„Ø¹Ù„Ù…ÙŠ ÙˆØ­Ø§Ø² Ø¹Ù„Ù‰ ØªÙ‚Ø¯ÙŠØ±"]}):e.jsxs(e.Fragment,{children:["Ù‚Ø¯ Ø£ØªÙ… Ø¨Ù†Ø¬Ø§Ø­ Ø¯ÙˆØ±Ø© ",e.jsxs("span",{className:"font-bold text-emerald-900",children:['"',a.courseTitle,'"']})," ÙˆØ­Ù‚Ù‚ Ù…ØªØ·Ù„Ø¨Ø§Øª Ø§Ù„Ø§Ø¬ØªÙŠØ§Ø² Ø¨ØªÙ‚Ø¯ÙŠØ±"]}),e.jsx("br",{}),e.jsx("span",{className:"font-bold text-gold-600 text-xl mt-2 inline-block",children:a.grade==="Distinction"?"Ø§Ù…ØªÙŠØ§Ø² Ù…Ø¹ Ù…Ø±ØªØ¨Ø© Ø§Ù„Ø´Ø±Ù":"Ù…Ù…ØªØ§Ø²"})]}),e.jsxs("div",{className:"flex justify-between w-full mt-auto px-16 items-end pb-10",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"h-10 w-40 border-b-2 border-emerald-900/30 mb-2 font-handwriting text-emerald-900 text-2xl",dir:"ltr",children:"Ahmed Ali"}),e.jsx("p",{className:"text-sm text-gray-500 font-bold",children:"Ø§Ù„Ù…Ø´Ø±Ù Ø§Ù„Ø¹Ø§Ù…"})]}),e.jsx("div",{className:"w-32 h-32 relative mx-8",children:e.jsx("div",{className:"absolute inset-0 border-4 border-gold-500 rounded-full flex items-center justify-center opacity-80 rotate-12 bg-white shadow-xl",children:e.jsxs("div",{className:"w-28 h-28 bg-emerald-900 rounded-full flex flex-col items-center justify-center text-white text-center leading-tight shadow-inner border-2 border-white/20",children:[e.jsx("span",{className:"text-[10px] opacity-70 mb-1",children:"Ø§Ù„Ù…ØµØ·Ø¨Ø© Ø§Ù„Ø¹Ù„Ù…ÙŠØ©"}),e.jsx("span",{className:"text-lg font-bold",children:"Ù…Ø¹ØªÙ…Ø¯"}),e.jsx("span",{className:"text-xs mt-1 font-mono",children:a.issueDate.split("-")[0]})]})})}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"h-10 w-40 border-b-2 border-emerald-900/30 mb-2 font-handwriting text-emerald-900 text-xl font-bold",children:"System Admin"}),e.jsx("p",{className:"text-sm text-gray-500 font-bold",children:"Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ù†ØµØ©"})]})]}),e.jsxs("div",{className:"absolute bottom-4 left-1/2 -translate-x-1/2 text-[10px] text-gray-400 font-mono tracking-widest",children:["ID: ",a.code]})]})]})]})]})};export{Q as default};
